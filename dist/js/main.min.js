function addNewOcean(e,t){db.oceans.put({name:e,seas:t,numOfSeas:t.seas.length})}var app=angular.module("OceanApp",["ngRoute","ngMockE2E","ngMessages","angular-web-notification"]);app.run(["$httpBackend",function(e){function t(e){for(var t=0;t<e.seas.length;t+=1){var o=Math.floor(7*Math.random()+1),i=(Math.floor(7*Math.random()+1),Math.floor(3*Math.random()+1)),a=(300*Math.random()-200).toFixed(2),r=(300*Math.random()-200).toFixed(2);e.seas[t].coords[0]=a,e.seas[t].coords[1]=r,e.seas[t].tide=n(i),e.seas[t].photo="img/thumb-"+o+".png"}return e}function n(e){return 1==e?"LOW":2==e?"MED":"HIGH"}var o={name:"Pacific Ocean",description:"",coords:[],seas:[{name:"Amundsen Gulf",id:100,coords:[-13.56,23.97],description:"Amundsen Gulf is a gulf located in Canadian Northwest Territories, between Banks Island and Victoria Island and the mainland. It is approximately 250 mi (400 km) in length and about 93 mi (150 km) across where it meets the Beaufort Sea. The Amundsen Gulf was explored by Norwegian explorer Roald Amundsen between 1903 and 1906. The gulf is at the western end of the famous Northwest Passage, a route from the Atlantic Ocean to the Pacific. ",photo:"img/thumb-1.png",surface:"1,175 km",currenttemp:"40˚ C / 160˚ F",depth:"1,253 m",volume:"547,000 km",togglecomments:!1,followers:[{name:"Mary",photo:"img/avatar-thumb-1.png",dateposted:"01/01/16"},{name:"John",photo:"img/avatar-thumb-2.png",dateposted:"01/01/16"},{name:"Joe",photo:"img/avatar-thumb-3.png",dateposted:"01/01/16"}],tide:"HIGH",comments:[{name:"",img:"",date:"",comment:""},{name:"",img:"",date:"",comment:""}]},{name:"James Bay",id:100,coords:[-13.56,23.97],description:"James Bay is a large body of water on the southern end of Hudson Bay in Canada. Both bodies of water extend from the Arctic Ocean, of which James Bay is the southernmost part. It borders the provinces of Quebec and Ontario; islands within the bay (the largest of which is Akimiski Island) are part of Nunavut. The James Bay watershed is the site of several major hydroelectric projects, and is also a destination for river-based recreation. Several communities are located near or alongside James Bay, including a number of Aboriginal communities such as the Kashechewan First Nation and nine communities affiliated with the Crees of northern Quebec. As with the rest of Hudson Bay, the waters of James Bay routinely freeze over in winter, although it is the last to freeze over in winter, and conversely the first to thaw in summer. ",photo:"img/thumb-1.png",surface:"1,175 km",currenttemp:"40˚ C / 160˚ F",depth:"1,253 m",volume:"547,000 km",togglecomments:!1,followers:[{name:"Mary",photo:"img/avatar-thumb-1.png",dateposted:"01/01/16"},{name:"John",photo:"img/avatar-thumb-2.png",dateposted:"01/01/16"},{name:"Joe",photo:"img/avatar-thumb-3.png",dateposted:"01/01/16"}],tide:"HIGH",comments:[{name:"",img:"",date:"",comment:""},{name:"",img:"",date:"",comment:""}]},{name:"Baffin Bay",id:100,coords:[-13.56,23.97],description:"Baffin Bay, located between Baffin Island and the southwest coast of Greenland, is a marginal sea of the North Atlantic Ocean. It is connected to the Atlantic via Davis Strait and the Labrador Sea. The narrower Nares Strait connects Baffin Bay with the Arctic Ocean. The bay is not navigable most of the year because of the ice cover and high density of floating ice and icebergs in the open areas. However, a polynya of about 80,000 km2 (31,000 sq mi), known as the North Water, opens in summer on the north near Smith Sound. Most of the aquatic life of the bay is concentrated near that region. ",photo:"img/thumb-1.png",surface:"1,175 km",currenttemp:"40˚ C / 160˚ F",depth:"1,253 m",volume:"547,000 km",togglecomments:!1,followers:[{name:"Mary",photo:"img/avatar-thumb-1.png",dateposted:"01/01/16"},{name:"John",photo:"img/avatar-thumb-2.png",dateposted:"01/01/16"},{name:"Joe",photo:"img/avatar-thumb-3.png",dateposted:"01/01/16"}],tide:"HIGH",comments:[{name:"",img:"",date:"",comment:""},{name:"",img:"",date:"",comment:""}]},{name:"Kara Sea",id:100,coords:[-13.56,23.97],description:'The Kara Sea is part of the Arctic Ocean north of Siberia. It is separated from the Barents Sea to the west by the Kara Strait and Novaya Zemlya, and the Laptev Sea to the east by the Severnaya Zemlya archipelago. It is named for the Kara River (flowing into Baydaratskaya Bay), which is now relatively insignificant but which played an important role in the Russian conquest of northern Siberia. The word "kara" is derived from kara, which in several Turkic languages means "black" and also symbolizes "north". The Kara Sea\'s northern limit is marked geographically by a line running from Cape Kohlsaat in Graham Bell Island, Franz Josef Land, to Cape Molotov (Arctic Cape), the northernmost point of Komsomolets Island in Severnaya Zemlya. ',photo:"img/thumb-1.png",surface:"1,175 km",currenttemp:"40˚ C / 160˚ F",depth:"1,253 m",volume:"547,000 km",togglecomments:!1,followers:[{name:"Mary",photo:"img/avatar-thumb-1.png",dateposted:"01/01/16"},{name:"John",photo:"img/avatar-thumb-2.png",dateposted:"01/01/16"},{name:"Joe",photo:"img/avatar-thumb-3.png",dateposted:"01/01/16"}],tide:"HIGH",comments:[{name:"",img:"",date:"",comment:""},{name:"",img:"",date:"",comment:""}]},{name:"Barents Sea",id:100,coords:[-13.56,23.97],description:'The Barents Sea is a marginal sea of the Arctic Ocean, located off the northern coasts of Norway and Russia divided between Norwegian and Russian territorial waters. Known among Russians in the Middle Ages as the Murman Sea ("Norwegian Sea"), the sea takes its current name from the Dutch navigator Willem Barentsz. It is a rather shallow shelf sea, with an average depth of 230 metres (750 ft), and is an important site for both fishing and hydrocarbon exploration. The Barents Sea is bordered by the Kola Peninsula to the south, the shelf edge towards the Norwegian Sea to the west, and the archipelagos of Svalbard to the northwest, Franz Josef Land to the north east and Novaya Zemlya to the east. Novaya Zemlya, an extension of the northern part of the Ural Mountains, separates the Barents Sea from the Kara Sea. ',photo:"img/thumb-1.png",surface:"1,175 km",currenttemp:"40˚ C / 160˚ F",depth:"1,253 m",volume:"547,000 km",togglecomments:!1,followers:[{name:"Mary",photo:"img/avatar-thumb-1.png",dateposted:"01/01/16"},{name:"John",photo:"img/avatar-thumb-2.png",dateposted:"01/01/16"},{name:"Joe",photo:"img/avatar-thumb-3.png",dateposted:"01/01/16"}],tide:"HIGH",comments:[{name:"",img:"",date:"",comment:""},{name:"",img:"",date:"",comment:""}]}]},i={name:"Pacific Ocean",description:"",coords:[],seas:[{name:"Davis Strait",id:100,coords:[-13.56,23.97],description:"Davis Strait is a northern arm of the Labrador Sea. It lies between mid-western Greenland and Nunavut, Canada's Baffin Island. To the north is Baffin Bay. The strait was named for the English explorer John Davis (1550–1605), who explored the area while seeking a Northwest Passage. By the 1650s it was used for whale hunting. ",photo:"img/thumb-1.png",surface:"1,175 km",currenttemp:"40˚ C / 160˚ F",depth:"1,253 m",volume:"547,000 km",togglecomments:!1,followers:[{name:"Mary",photo:"img/avatar-thumb-1.png",dateposted:"01/01/16"},{name:"John",photo:"img/avatar-thumb-2.png",dateposted:"01/01/16"},{name:"Joe",photo:"img/avatar-thumb-3.png",dateposted:"01/01/16"}],tide:"HIGH",comments:[{name:"",img:"",date:"",comment:""},{name:"",img:"",date:"",comment:""}]},{name:"Labrador Sea",id:100,coords:[-13.56,23.97],description:"The Labrador Sea is an arm of the North Atlantic Ocean between the Labrador Peninsula and Greenland. The sea is flanked by continental shelves to the southwest, northwest, and northeast. It connects to the north with Baffin Bay through the Davis Strait. It has been described as a marginal sea of the Atlantic. The sea formed upon separation of the North American Plate and Greenland Plate that started about 60 million years ago and stopped about 40 million years ago. It contains one of the world's largest turbidity current channel systems, the Northwest Atlantic Mid-Ocean Channel (NAMOC), that runs for thousands of kilometers along the sea bottom toward the Atlantic Ocean. ",photo:"img/thumb-1.png",surface:"1,175 km",currenttemp:"40˚ C / 160˚ F",depth:"1,253 m",volume:"547,000 km",togglecomments:!1,followers:[{name:"Mary",photo:"img/avatar-thumb-1.png",dateposted:"01/01/16"},{name:"John",photo:"img/avatar-thumb-2.png",dateposted:"01/01/16"},{name:"Joe",photo:"img/avatar-thumb-3.png",dateposted:"01/01/16"}],tide:"HIGH",comments:[{name:"",img:"",date:"",comment:""},{name:"",img:"",date:"",comment:""}]},{name:"Gulf of St. Lawrence",id:100,coords:[-13.56,23.97],description:"The Gulf of Saint Lawrence is the outlet of the North American Great Lakes via the Saint Lawrence River into the Atlantic Ocean. The gulf is a semienclosed sea, covering an area of about 236,000 square kilometres (91,000 sq mi) and containing about 35,000 cubic kilometres (8,400 cu mi) of water, which results in an average depth of 148 metres (486 ft).",photo:"img/thumb-1.png",surface:"1,175 km",currenttemp:"40˚ C / 160˚ F",depth:"1,253 m",volume:"547,000 km",togglecomments:!1,followers:[{name:"Mary",photo:"img/avatar-thumb-1.png",dateposted:"01/01/16"},{name:"John",photo:"img/avatar-thumb-2.png",dateposted:"01/01/16"},{name:"Joe",photo:"img/avatar-thumb-3.png",dateposted:"01/01/16"}],tide:"HIGH",comments:[{name:"",img:"",date:"",comment:""},{name:"",img:"",date:"",comment:""}]},{name:"Gulf of Maine",id:100,coords:[-13.56,23.97],description:"The Gulf of Maine is a large gulf of the Atlantic Ocean on the east coast of North America. It is delineated by Cape Cod at the eastern tip of Massachusetts in the southwest and Cape Sable Island at the southern tip of Nova Scotia in the northeast. It includes the entire coastlines of the U.S. states of New Hampshire and Maine, as well as Massachusetts north of Cape Cod, and the southern and western coastlines of the Canadian provinces of New Brunswick and Nova Scotia, respectively. Both Massachusetts Bay and the Bay of Fundy are included within the Gulf of Maine system. As such, the Gulf of Maine is also home to the highest tidal variations on the planet. ",photo:"img/thumb-1.png",surface:"1,175 km",currenttemp:"40˚ C / 160˚ F",depth:"1,253 m",volume:"547,000 km",togglecomments:!1,followers:[{name:"Mary",photo:"img/avatar-thumb-1.png",dateposted:"01/01/16"},{name:"John",photo:"img/avatar-thumb-2.png",dateposted:"01/01/16"},{name:"Joe",photo:"img/avatar-thumb-3.png",dateposted:"01/01/16"}],tide:"HIGH",comments:[{name:"",img:"",date:"",comment:""},{name:"",img:"",date:"",comment:""}]},{name:"Nantucket Sound",id:100,coords:[-13.56,23.97],description:"Nantucket Sound is a roughly triangular area of the Atlantic Ocean offshore from the U.S. state of Massachusetts. It is 30 miles (48 km) long and 25 miles (40 km) wide, and is enclosed by Cape Cod on the north, Nantucket on the south, and Martha's Vineyard on the west. Between Cape Cod and Martha's Vineyard it is connected to the Vineyard Sound. Ports on Nantucket Sound include Nantucket and Hyannis, Massachusetts. Nantucket Sound possesses significant marine habitat for a diversity of ecologically and economically important species. \"The Sound\" has particular significance for several federally protected species of wildlife and a variety of commercially and recreationally valuable fisheries. ",photo:"img/thumb-1.png",surface:"1,175 km",currenttemp:"40˚ C / 160˚ F",depth:"1,253 m",volume:"547,000 km",togglecomments:!1,followers:[{name:"Mary",photo:"img/avatar-thumb-1.png",dateposted:"01/01/16"},{name:"John",photo:"img/avatar-thumb-2.png",dateposted:"01/01/16"},{name:"Joe",photo:"img/avatar-thumb-3.png",dateposted:"01/01/16"}],tide:"HIGH",comments:[{name:"",img:"",date:"",comment:""},{name:"",img:"",date:"",comment:""}]}]},a={name:"Pacific Ocean",description:"",coords:[],seas:[{name:"Andaman Sea",id:100,coords:[-13.56,23.97],description:"The Andaman Sea is a body of water to the southeast of the Bay of Bengal, south of Myanmar (Burma), west of Thailand, north-west of Malay Peninsula, north of Sumatra and east of the Andaman Islands, India, from which it takes its name; it is part of the Indian Ocean. The sea has been traditionally used for fishery and transportation of goods between the coastal countries and its coral reefs and islands are popular tourist destinations. The fishery and tourist infrastructure was severely damaged by the 2004 Indian Ocean earthquake and tsunami. ",photo:"img/thumb-1.png",surface:"1,175 km",currenttemp:"40˚ C / 160˚ F",depth:"1,253 m",volume:"547,000 km",togglecomments:!1,followers:[{name:"Mary",photo:"img/avatar-thumb-1.png",dateposted:"01/01/16"},{name:"John",photo:"img/avatar-thumb-2.png",dateposted:"01/01/16"},{name:"Joe",photo:"img/avatar-thumb-3.png",dateposted:"01/01/16"}],tide:"HIGH",comments:[{name:"",img:"",date:"",comment:""},{name:"",img:"",date:"",comment:""}]},{name:"Arabian Sea",id:100,coords:[-13.56,23.97],description:"The Arabian Sea is a region of the northern Indian Ocean bounded on the north by Pakistan and Iran, on the west by northeastern Somalia and the Arabian Peninsula, and on the east by India. Historically the sea has been known by other names including the Erythraean Sea and the Persian Sea. Its total area is 3,862,000 km2 (1,491,000 sq mi) and its maximum depth is 4,652 metres (15,262 ft). The Gulf of Aden is in the southwest, connecting the Arabian Sea to the Red Sea through the strait of Bab-el-Mandeb, and the Gulf of Oman is in the northwest, connecting it to the Persian Gulf. ",photo:"img/thumb-1.png",surface:"1,175 km",currenttemp:"40˚ C / 160˚ F",depth:"1,253 m",volume:"547,000 km",togglecomments:!1,followers:[{name:"Mary",photo:"img/avatar-thumb-1.png",dateposted:"01/01/16"},{name:"John",photo:"img/avatar-thumb-2.png",dateposted:"01/01/16"},{name:"Joe",photo:"img/avatar-thumb-3.png",dateposted:"01/01/16"}],tide:"HIGH",comments:[{name:"",img:"",date:"",comment:""},{name:"",img:"",date:"",comment:""}]},{name:"Bay of Bengal",id:100,coords:[-13.56,23.97],description:"The Bay of Bengal, the largest bay in the world, forms the northeastern part of the Indian Ocean. Roughly triangular, it is bordered mostly by India and Sri Lanka to the west, Bangladesh to the north, and Myanmar (Burma) and the Andaman and Nicobar Islands to the east. The Bay of Bengal occupies an area of 2,172,000 square kilometres (839,000 sq mi). A number of large rivers – the Ganges and its tributaries such as the Padma and Hooghly, the Brahmaputra and its tributaries such as the Jamuna and Meghna, other rivers such as the Irrawaddy River, Godavari, Mahanadi, Krishna and Kaveri flow into the Bay of Bengal. Among the important ports are Chennai, Chittagong, Kolkata, Mongla, Paradip, Tuticorin, Visakhapatnam and Yangon. ",photo:"img/thumb-1.png",surface:"1,175 km",currenttemp:"40˚ C / 160˚ F",depth:"1,253 m",volume:"547,000 km",togglecomments:!1,followers:[{name:"Mary",photo:"img/avatar-thumb-1.png",dateposted:"01/01/16"},{name:"John",photo:"img/avatar-thumb-2.png",dateposted:"01/01/16"},{name:"Joe",photo:"img/avatar-thumb-3.png",dateposted:"01/01/16"}],tide:"HIGH",comments:[{name:"",img:"",date:"",comment:""},{name:"",img:"",date:"",comment:""}]},{name:"Gulf of Aden",id:100,coords:[-13.56,23.97],description:'The Gulf of Aden is a gulf located in the Arabian Sea between Yemen, on the south coast of the Arabian Peninsula, and Somalia in the Horn of Africa. In the northwest, it connects with the Red Sea through the Bab-el-Mandeb strait, which is more than 20 miles wide. It shares its name with the port city of Aden in Yemen, which forms the northern shore of the gulf. Historically the Gulf of Aden was known as "The Gulf of Berbera", named after the ancient Somali port city of Berbera on the south side of the gulf. However, as the city of Aden grew during the colonial era, the name of "Gulf of Aden" was popularised. The waterway is part of the important Suez canal shipping route between the Mediterranean Sea and the Arabian Sea in the Indian Ocean with 21,000 ships crossing the gulf annually. ',photo:"img/thumb-1.png",surface:"1,175 km",currenttemp:"40˚ C / 160˚ F",depth:"1,253 m",volume:"547,000 km",togglecomments:!1,followers:[{name:"Mary",photo:"img/avatar-thumb-1.png",dateposted:"01/01/16"},{name:"John",photo:"img/avatar-thumb-2.png",dateposted:"01/01/16"},{name:"Joe",photo:"img/avatar-thumb-3.png",dateposted:"01/01/16"}],tide:"HIGH",comments:[{name:"",img:"",date:"",comment:""},{name:"",img:"",date:"",comment:""}]},{name:"Gulf of Oman",id:100,coords:[-13.56,23.97],description:"The Gulf of Oman or Sea of Oman is a strait (and not an actual gulf) that connects the Arabian Sea with the Strait of Hormuz, which then runs to the Persian Gulf. It is generally included as a branch of the Persian Gulf, not as an arm of the Arabian Sea. The gulf borders Pakistan and Iran on the north, Oman on the south, and the United Arab Emirates on the west. ",photo:"img/thumb-1.png",surface:"1,175 km",currenttemp:"40˚ C / 160˚ F",depth:"1,253 m",volume:"547,000 km",togglecomments:!1,followers:[{name:"Mary",photo:"img/avatar-thumb-1.png",dateposted:"01/01/16"},{name:"John",photo:"img/avatar-thumb-2.png",dateposted:"01/01/16"},{name:"Joe",photo:"img/avatar-thumb-3.png",dateposted:"01/01/16"}],tide:"HIGH",comments:[{name:"",img:"",date:"",comment:""},{name:"",img:"",date:"",comment:""}]}]},r={name:"Pacific Ocean",description:"",coords:[],seas:[{name:"Arafura Sea",id:100,coords:[-13.56,23.97],description:"The Arafura Sea is bordered by Torres Strait and through that the Coral Sea to the east, the Gulf of Carpentaria to the south, the Timor Sea to the west and the Banda and Ceram seas to the northwest. It is 1,290 kilometres (800 mi) long and 560 kilometres (350 mi) wide. The depth of the sea is primarily 50–80 metres (165–265 feet) with the depth increasing to the west. As a shallow tropical sea, its waters are a breeding ground for tropical cyclones. The sea lies over the Arafura Shelf, part of the Sahul Shelf. When sea levels were low during the last glacial maximum, the Arafura Shelf, the Gulf of Carpentaria and Torres Strait formed a large flat land bridge connecting Australia and New Guinea and easing migration of humans from Asia into Australia. The combined landmass formed the continent of Sahul. ",photo:"img/thumb-1.png",surface:"1,175 km",currenttemp:"40˚ C / 160˚ F",depth:"1,253 m",volume:"547,000 km",togglecomments:!1,followers:[{name:"Mary",photo:"img/avatar-thumb-1.png",dateposted:"01/01/16"},{name:"John",photo:"img/avatar-thumb-2.png",dateposted:"01/01/16"},{name:"Joe",photo:"img/avatar-thumb-3.png",dateposted:"01/01/16"}],tide:"HIGH",comments:[{name:"",img:"",date:"",comment:""},{name:"",img:"",date:"",comment:""}]},{name:"Banda Sea",id:100,coords:[-13.56,23.97],description:"The Banda Sea is a sea in the Maluku Islands of Indonesia, connected to the Pacific Ocean but surrounded by hundreds of islands, as well as the Halmahera and Ceram Seas. It is about 1000 km (600 mi) east to west, and about 500 km (300 mi) north to south. ",photo:"img/thumb-1.png",surface:"1,175 km",currenttemp:"40˚ C / 160˚ F",depth:"1,253 m",volume:"547,000 km",togglecomments:!1,followers:[{name:"Mary",photo:"img/avatar-thumb-1.png",dateposted:"01/01/16"},{name:"John",photo:"img/avatar-thumb-2.png",dateposted:"01/01/16"},{name:"Joe",photo:"img/avatar-thumb-3.png",dateposted:"01/01/16"}],tide:"HIGH",comments:[{name:"",img:"",date:"",comment:""},{name:"",img:"",date:"",comment:""}]},{name:"Bali Sea",id:100,coords:[-13.56,23.97],description:"The Bali Sea is the body of water north of the island of Bali and south of Kangean Island in Indonesia. The sea forms the south-west part of the Flores Sea, and the Madura Strait opens into it from the west. ",photo:"img/thumb-1.png",surface:"1,175 km",currenttemp:"40˚ C / 160˚ F",depth:"1,253 m",volume:"547,000 km",togglecomments:!1,followers:[{name:"Mary",photo:"img/avatar-thumb-1.png",dateposted:"01/01/16"},{name:"John",photo:"img/avatar-thumb-2.png",dateposted:"01/01/16"},{name:"Joe",photo:"img/avatar-thumb-3.png",dateposted:"01/01/16"}],tide:"HIGH",comments:[{name:"",img:"",date:"",comment:""},{name:"",img:"",date:"",comment:""}]},{name:"The Arafura Sea",id:100,coords:[-13.56,23.97],description:"The Arafura Sea is bordered by Torres Strait and through that the Coral Sea to the east, the Gulf of Carpentaria to the south, the Timor Sea to the west and the Banda and Ceram seas to the northwest. It is 1,290 kilometres (800 mi) long and 560 kilometres (350 mi) wide. The depth of the sea is primarily 50–80 metres (165–265 feet) with the depth increasing to the west. As a shallow tropical sea, its waters are a breeding ground for tropical cyclones. ",photo:"img/thumb-1.png",surface:"1,175 km",currenttemp:"40˚ C / 160˚ F",depth:"1,253 m",volume:"547,000 km",togglecomments:!1,followers:[{name:"Mary",photo:"img/avatar-thumb-1.png",dateposted:"01/01/16"},{name:"John",photo:"img/avatar-thumb-2.png",dateposted:"01/01/16"},{name:"Joe",photo:"img/avatar-thumb-3.png",dateposted:"01/01/16"}],tide:"HIGH",comments:[{name:"",img:"",date:"",comment:""},{name:"",img:"",date:"",comment:""}]},{name:"Kara Sea",id:100,coords:[-13.56,23.97],description:'The Kara Sea is part of the Arctic Ocean north of Siberia. It is separated from the Barents Sea to the west by the Kara Strait and Novaya Zemlya, and the Laptev Sea to the east by the Severnaya Zemlya archipelago. It is named for the Kara River (flowing into Baydaratskaya Bay), which is now relatively insignificant but which played an important role in the Russian conquest of northern Siberia. The word "kara" is derived from kara, which in several Turkic languages means "black" and also symbolizes "north". ',photo:"img/thumb-1.png",surface:"1,175 km",currenttemp:"40˚ C / 160˚ F",depth:"1,253 m",volume:"547,000 km",togglecomments:!1,followers:[{name:"Mary",photo:"img/avatar-thumb-1.png",dateposted:"01/01/16"},{name:"John",photo:"img/avatar-thumb-2.png",dateposted:"01/01/16"},{name:"Joe",photo:"img/avatar-thumb-3.png",dateposted:"01/01/16"}],tide:"HIGH",comments:[{name:"",img:"",date:"",comment:""},{name:"",img:"",date:"",comment:""}]}]},s={name:"Southern Ocean",description:"",coords:[],seas:[{name:"Amundsen Sea",id:100,coords:[-13.56,23.97],description:"The Amundsen Sea, an arm of the Southern Ocean off Marie Byrd Land in western Antarctica, lies between Cape Flying Fish (the northwestern tip of Thurston Island) to the east and Cape Dart on Siple Island to the west. Cape Flying Fish marks the boundary between the Amundsen Sea and the Bellingshausen Sea. West of Cape Dart there is no named marginal sea of the Southern Ocean between the Amundsen and Ross Seas. The Norwegian expedition of 1928–1929 under Captain Nils Larsen named the body of water for the Norwegian polar explorer Roald Amundsen while exploring this area in February 1929. The sea is mostly ice-covered, and the Thwaites Ice Tongue protrudes into it. The ice sheet which drains into the Amundsen Sea averages about 3 km (1.9 mi) in thickness; roughly the size of the state of Texas, this area is known as the Amundsen Sea Embayment (ASE); it forms one of the three major ice-drainage basins of the West Antarctic Ice Sheet. ",photo:"img/thumb-1.png",surface:"1,175 km",currenttemp:"40˚ C / 160˚ F",depth:"1,253 m",volume:"547,000 km",togglecomments:!1,followers:[{name:"Mary",photo:"img/avatar-thumb-1.png",dateposted:"01/01/16"},{name:"John",photo:"img/avatar-thumb-2.png",dateposted:"01/01/16"},{name:"Joe",photo:"img/avatar-thumb-3.png",dateposted:"01/01/16"}],tide:"HIGH",comments:[{name:"",img:"",date:"",comment:""},{name:"",img:"",date:"",comment:""}]},{name:"Bass Strait",id:100,coords:[-13.56,23.97],description:"Bass Strait is a sea strait separating Tasmania from the Australian mainland, specifically the state of Victoria. ",photo:"img/thumb-1.png",surface:"1,175 km",currenttemp:"40˚ C / 160˚ F",depth:"1,253 m",volume:"547,000 km",togglecomments:!1,followers:[{name:"Mary",photo:"img/avatar-thumb-1.png",dateposted:"01/01/16"},{name:"John",photo:"img/avatar-thumb-2.png",dateposted:"01/01/16"},{name:"Joe",photo:"img/avatar-thumb-3.png",dateposted:"01/01/16"}],tide:"HIGH",comments:[{name:"",img:"",date:"",comment:""},{name:"",img:"",date:"",comment:""}]},{name:"Bellingshausen Sea",id:100,coords:[-13.56,23.97],description:"The Bellingshausen Sea is an area along the west side of the Antarctic Peninsula between 57°18'W and 102°20'W, west of Alexander Island, east of Cape Flying Fish on Thurston Island, and south of Peter I Island (there the southern Vostokkysten). In the south are, from west to east, Eights Coast, Bryan Coast and English Coast (west part) of West Antarctica. To the west of Cape Flying Fish joins Amundsen Sea. Bellingshausen Sea has an area of 487,000 km2 (188,000 sq mi) and reaches a maximum depth of 4.5 kilometers (2.8 mi). It contains the undersea plain Bellingshausen Plain. ",photo:"img/thumb-1.png",surface:"1,175 km",currenttemp:"40˚ C / 160˚ F",depth:"1,253 m",volume:"547,000 km",togglecomments:!1,followers:[{name:"Mary",photo:"img/avatar-thumb-1.png",dateposted:"01/01/16"},{name:"John",photo:"img/avatar-thumb-2.png",dateposted:"01/01/16"},{name:"Joe",photo:"img/avatar-thumb-3.png",dateposted:"01/01/16"}],tide:"HIGH",comments:[{name:"",img:"",date:"",comment:""},{name:"",img:"",date:"",comment:""}]},{name:"Cooperation Sea",id:100,coords:[-13.56,23.97],description:"Cooperation Sea, also called Commonwealth Sea (erratum) or Sodruzhestvo Sea, is a proposed sea name for part of the Southern Ocean, between Enderby Land (the eastern limit of which is 59°34'E) and West Ice Shelf (85°E), off the coast of MacRobertson Land and Princess Elizabeth Land. It would stretch over an area of 258,000 km². It would be bordered by the Davis Sea on the east, and by another Russian proposal to the 2002 International Hydrographic Organization (IHO) draft, a Cosmonauts Sea to the west. ",photo:"img/thumb-1.png",surface:"1,175 km",currenttemp:"40˚ C / 160˚ F",depth:"1,253 m",volume:"547,000 km",togglecomments:!1,followers:[{name:"Mary",photo:"img/avatar-thumb-1.png",dateposted:"01/01/16"},{name:"John",photo:"img/avatar-thumb-2.png",dateposted:"01/01/16"},{name:"Joe",photo:"img/avatar-thumb-3.png",dateposted:"01/01/16"}],tide:"HIGH",comments:[{name:"",img:"",date:"",comment:""},{name:"",img:"",date:"",comment:""}]},{name:"Cosmonauts Sea",id:100,coords:[-13.56,23.97],description:"Cosmonauts Sea, sometimes misspelled Cosmonaut Sea, was a proposed sea name as part of the Southern Ocean, off the Prince Olav Coast and Enderby Land, Antarctica, between about 30°E and 50°E.[1] It would have an area of 699,000 km². It would be bordered by two other proposals from a 2002 International Hydrographic Organization (IHO) draft, a Cooperation Sea to the east, and to the west a Riiser-Larsen Sea. ",photo:"img/thumb-1.png",surface:"1,175 km",currenttemp:"40˚ C / 160˚ F",depth:"1,253 m",volume:"547,000 km",togglecomments:!1,followers:[{name:"Mary",photo:"img/avatar-thumb-1.png",dateposted:"01/01/16"},{name:"John",photo:"img/avatar-thumb-2.png",dateposted:"01/01/16"},{name:"Joe",photo:"img/avatar-thumb-3.png",dateposted:"01/01/16"}],tide:"HIGH",comments:[{name:"",img:"",date:"",comment:""},{name:"",img:"",date:"",comment:""}]}]},u={name:"Pacific Ocean",description:"",coords:[],seas:[{name:"Amundsen Gulf",id:100,coords:[-13.56,23.97],description:"Amundsen Gulf is a gulf located in Canadian Northwest Territories, between Banks Island and Victoria Island and the mainland. It is approximately 250 mi (400 km) in length and about 93 mi (150 km) across where it meets the Beaufort Sea. The Amundsen Gulf was explored by Norwegian explorer Roald Amundsen between 1903 and 1906. The gulf is at the western end of the famous Northwest Passage, a route from the Atlantic Ocean to the Pacific. ",photo:"img/thumb-1.png",surface:"1,175 km",currenttemp:"40˚ C / 160˚ F",depth:"1,253 m",volume:"547,000 km",togglecomments:!1,followers:[{name:"Mary",photo:"img/avatar-thumb-1.png",dateposted:"01/01/16"},{name:"John",photo:"img/avatar-thumb-2.png",dateposted:"01/01/16"},{name:"Joe",photo:"img/avatar-thumb-3.png",dateposted:"01/01/16"}],tide:"HIGH",comments:[{name:"",img:"",date:"",comment:""},{name:"",img:"",date:"",comment:""}]}]};e.whenGET(/\.html$/).passThrough(),e.whenGET("api/artic").respond(t(o)),e.whenGET("api/atlantic").respond(t(i)),e.whenGET("api/indian").respond(t(a)),e.whenGET("api/pacific").respond(t(r)),e.whenGET("api/southern").respond(t(s)),e.whenGET("api/account").respond(t(u))}]),app.factory("OceansService",["$http",function(e){var t=function(t){var n="api/"+t;return e.get(n).then(function(e){return console.log("Inside the service"),addNewOcean(t,e.data),e.data})};return{getOceans:t}}]),app.factory("LoginService",function(){var e={myUrl:"img/avatar/blank.png",myUserName:"123",isSignedIn:!1,getUrl:function(){return e.myUrl},getUserName:function(){return e.myUserName},setUserName:function(t){e.myUserName=t},changeUrl:function(t){e.myUrl=t},getSignedIn:function(){return e.isSignedIn},signIn:function(){e.isSignedIn=!0},signOut:function(){e.isSignedIn=!1}};return e}),app.controller("MainController",["$scope","OceansService","thisJSON","webNotification","$timeout",function(e,t,n,o,i){function a(e,t){for(var n=0;n<t.length;n++)if(angular.equals(t[n],e))return!0;return!1}e.thisJSON=n,e.addFollowers=function(t){function n(e){o.showNotification("Oceans",{body:"Now following "+e,icon:"img/favicon-lrg.png",autoClose:4e3},function(e,t){e?window.alert("Unable to show notification: "+e.message):(console.log("Notification Shown."),setTimeout(function(){console.log("Hiding notification...."),t()},5e3))})}var r={name:"Julian Bishop",photo:"img/avatar-thumb-4.png"};a(r,e.thisJSON.seas[t].followers)!==!0&&e.thisJSON.seas[t].followers.push(r),i(function(){n(e.thisJSON.seas[t].name)},3e3)},e.isFollows=function(t){var n=e.thisJSON.seas[t].followers,o={name:"Julian Bishop",photo:"img/avatar-thumb-4.png"};return!!a(o,n)},e.appliedClass=function(e){return"LOW"==e?"sea-data-tide-low":"MED"==e?"sea-data-tide-med":"sea-data-tide-high"}}]),app.config(["$routeProvider",function(e){e.when("/account",{templateUrl:"ngViews/user/account.html",controller:"MainController",resolve:{thisJSON:["OceansService",function(e){return e.getOceans("account").then(function(e){return e})}]}}).when("/signin",{templateUrl:"ngViews/login/signin.html",controller:["$scope","LoginService","$location",function(e,t,n){e.hello=function(){t.signIn(),n.path("/")},e.checkEmail=function(e){if(!e)return"Please enter a valid email address"}}]}).when("/signup",{templateUrl:"ngViews/login/signup.html",controller:["$scope","LoginService","$location",function(e,t,n){e.submitSignUp=function(){console.log("Hello"),n.path("/"),console.log("Hello")},e.submitForm=function(){e.userForm.$valid&&alert("our form is amazing")}}]}).when("/signout",{templateUrl:"ngViews/login/signout.html"}).when("/",{templateUrl:"ngViews/main.html",controller:"MainController",resolve:{thisJSON:["OceansService","$route",function(e,t){return e.getOceans("artic").then(function(e){return e})}]}}).when("/:paramType",{templateUrl:"ngViews/main.html",controller:"MainController",resolve:{thisJSON:["OceansService","$route",function(e,t){var n=t.current.params.paramType;return e.getOceans(n).then(function(e){return e})}]}})}]),app.directive("navBar",function(){return{templateUrl:"ngViews/navbar/navbar.html",controller:["$scope","LoginService",function(e,t){e.loggedin=function(){return t.isSignedIn},e.hello=function(){return t.isSignedIn?"bubble":"bubble-short"},e.userAvatar="img/avatar-thumb-7.png",e.signOut=function(){t.signOut()}}],restrict:"E"}}),app.directive("ocFooter",function(){return{templateUrl:"ngViews/footer/footer.html",restrict:"E",controller:["$scope","$location",function(e,t){e.showFooter=function(){return"/signup"!=t.path()&&"/signin"!=t.path()&&"/signout"!=t.path()}}]}}),app.directive("compareTo",function(){
return{require:"ngModel",scope:{otherModelValue:"=compareTo"},link:function(e,t,n,o){o.$validators.compareTo=function(t){return t==e.otherModelValue},e.$watch("otherModelValue",function(){o.$validate()})}}}),navigator.serviceWorker,function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.Dexie=t()}(this,function(){"use strict";function e(e,t){_e=e,xe=t}function t(){if(Ie)try{throw t.arguments,new Error}catch(e){return e}return new Error}function n(e,t){var n=e.stack;return n?(t=t||0,0===n.indexOf(e.name)&&(t+=(e.name+e.message).split("\n").length),n.split("\n").slice(t).filter(xe).map(function(e){return"\n"+e}).join("")):""}function o(){}function i(e){return e}function a(e,t){return null==e||e===i?t:function(n){return t(e(n))}}function r(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function s(e,t){return e===o?t:function(){var n=e.apply(this,arguments);void 0!==n&&(arguments[0]=n);var o=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var a=t.apply(this,arguments);return o&&(this.onsuccess=this.onsuccess?r(o,this.onsuccess):o),i&&(this.onerror=this.onerror?r(i,this.onerror):i),void 0!==a?a:n}}function u(e,t){return e===o?t:function(){e.apply(this,arguments);var n=this.onsuccess,o=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?r(n,this.onsuccess):n),o&&(this.onerror=this.onerror?r(o,this.onerror):o)}}function c(e,t){return e===o?t:function(n){var o=e.apply(this,arguments);d(n,o);var i=this.onsuccess,a=this.onerror;this.onsuccess=null,this.onerror=null;var s=t.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?r(i,this.onsuccess):i),a&&(this.onerror=this.onerror?r(a,this.onerror):a),void 0===o?void 0===s?void 0:s:d(o,s)}}function l(e,t){return e===o?t:function(){return t.apply(this,arguments)!==!1&&e.apply(this,arguments)}}function h(e,t){return e===o?t:function(){var n=e.apply(this,arguments);if(n&&"function"==typeof n.then){for(var o=this,i=arguments.length,a=new Array(i);i--;)a[i]=arguments[i];return n.then(function(){return t.apply(o,a)})}return t.apply(this,arguments)}}function d(e,t){return"object"!=typeof t?e:(Oe(t).forEach(function(n){e[n]=t[n]}),e)}function m(e,t){return Ee.call(e,t)}function f(e,t){"function"==typeof t&&(t=t(Ce(e))),Oe(t).forEach(function(n){p(e,n,t[n])})}function p(e,t,n,o){Object.defineProperty(e,t,d(n&&m(n,"get")&&"function"==typeof n.get?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},o))}function g(e){return{from:function(t){return e.prototype=Object.create(t.prototype),p(e.prototype,"constructor",e),{extend:f.bind(null,e.prototype)}}}}function v(e,t){var n,o=Pe(e,t);return o||(n=Ce(e))&&v(n,t)}function b(e,t,n){return Me.call(e,t,n)}function y(e,t){return t(e)}function w(e){var t=setTimeout(e,1e3);clearTimeout(t)}function k(e){if(!e)throw new Je.Internal("Assertion failed")}function S(e){Te.setImmediate?setImmediate(e):setTimeout(e,0)}function _(e,t){return e.reduce(function(e,n,o){var i=t(n,o);return i&&(e[i[0]]=i[1]),e},{})}function x(e,t){return function(){try{e.apply(this,arguments)}catch(e){t(e)}}}function I(e,t,n){try{e.apply(null,n)}catch(e){t&&t(e)}}function O(e,t){var n=K.reject(e);return t?n.uncaught(t):n}function A(e,t){if(m(e,t))return e[t];if(!t)return e;if("string"!=typeof t){for(var n=[],o=0,i=t.length;o<i;++o){var a=A(e,t[o]);n.push(a)}return n}var r=t.indexOf(".");if(r!==-1){var s=e[t.substr(0,r)];return void 0===s?void 0:A(s,t.substr(r+1))}}function T(e,t,n){if(e&&void 0!==t&&!("isFrozen"in Object&&Object.isFrozen(e)))if("string"!=typeof t&&"length"in t){k("string"!=typeof n&&"length"in n);for(var o=0,i=t.length;o<i;++o)T(e,t[o],n[o])}else{var a=t.indexOf(".");if(a!==-1){var r=t.substr(0,a),s=t.substr(a+1);if(""===s)void 0===n?delete e[r]:e[r]=n;else{var u=e[r];u||(u=e[r]={}),T(u,s,n)}}else void 0===n?delete e[t]:e[t]=n}}function C(e,t){"string"==typeof t?T(e,t,void 0):"length"in t&&[].map.call(t,function(t){T(e,t,void 0)})}function E(e){var t={};for(var n in e)m(e,n)&&(t[n]=e[n]);return t}function P(e){if(!e||"object"!=typeof e)return e;var t;if(Ae(e)){t=[];for(var n=0,o=e.length;n<o;++n)t.push(P(e[n]))}else if(e instanceof Date)t=new Date,t.setTime(e.getTime());else{t=e.constructor?Object.create(e.constructor.prototype):{};for(var i in e)m(e,i)&&(t[i]=P(e[i]))}return t}function M(e,t,n,o){return n=n||{},o=o||"",Oe(e).forEach(function(i){if(m(t,i)){var a=e[i],r=t[i];"object"==typeof a&&"object"==typeof r&&a&&r&&a.constructor===r.constructor?M(a,r,n,o+i+"."):a!==r&&(n[o+i]=t[i])}else n[o+i]=void 0}),Oe(t).forEach(function(i){m(e,i)||(n[o+i]=t[i])}),n}function j(e){var t,n,o,i;if(1===arguments.length){if(Ae(e))return e.slice();if(this===Ne&&"string"==typeof e)return[e];if(i=Be(e)){for(n=[];o=i.next(),!o.done;)n.push(o.value);return n}if(null==e)return[e];if(t=e.length,"number"==typeof t){for(n=new Array(t);t--;)n[t]=e[t];return n}return[e]}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}function B(e){return De.apply([],e)}function N(e,n){this._e=t(),this.name=e,this.message=n}function D(e,t){return e+". Errors: "+t.map(function(e){return e.toString()}).filter(function(e,t,n){return n.indexOf(e)===t}).join("\n")}function L(e,n,o,i){this._e=t(),this.failures=n,this.failedKeys=i,this.successCount=o}function z(e,n){this._e=t(),this.name="BulkError",this.failures=n,this.message=D(e,n)}function H(e,t){if(!e||e instanceof N||e instanceof TypeError||e instanceof SyntaxError||!e.name||!qe[e.name])return e;var n=new qe[e.name](t||e.message,e);return"stack"in e&&p(n,"stack",{get:function(){return this.inner.stack}}),n}function F(e){function t(e,t,i){if("object"==typeof e)return n(e);t||(t=l),i||(i=o);var s={subscribers:[],fire:i,subscribe:function(e){s.subscribers.indexOf(e)===-1&&(s.subscribers.push(e),s.fire=t(s.fire,e))},unsubscribe:function(e){s.subscribers=s.subscribers.filter(function(t){return t!==e}),s.fire=s.subscribers.reduce(t,i)}};return a[e]=r[e]=s,s}function n(e){Oe(e).forEach(function(n){var o=e[n];if(Ae(o))t(n,e[n][0],e[n][1]);else{if("asap"!==o)throw new Je.InvalidArgument("Invalid event config");var a=t(n,i,function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];a.subscribers.forEach(function(e){S(function(){e.apply(null,t)})})})}})}var a={},r=function(t,n){if(n){for(var o=arguments.length,i=new Array(o-1);--o;)i[o-1]=arguments[o];return a[t].subscribe.apply(null,i),e}if("string"==typeof t)return a[t]};r.addEventType=t;for(var s=1,u=arguments.length;s<u;++s)t(arguments[s]);return r}function K(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=o,this._lib=!1;var n=this._PSD=at;if(_e&&(this._stackHolder=t(),this._prev=null,this._numPrev=0,$(this,nt)),"function"!=typeof e){if(e!==Ue)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&q(this,this._value))}this._state=null,this._value=null,++n.ref,J(this,e)}function G(e,t,n,o){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=n,this.reject=o,this.psd=at}function J(e,t){try{t(function(t){if(null===e._state){if(t===e)throw new TypeError("A promise cannot be resolved with itself.");var n=e._lib&&Q();t&&"function"==typeof t.then?J(e,function(e,n){t instanceof K?t._then(e,n):t.then(e,n)}):(e._state=!0,e._value=t,R(e)),n&&Y()}},q.bind(null,e))}catch(t){q(e,t)}}function q(e,t){if(tt.push(t),null===e._state){var n=e._lib&&Q();t=ot(t),e._state=!1,e._value=t,_e&&null!==t&&"object"==typeof t&&!t._promise&&I(function(){var n=v(t,"stack");t._promise=e,p(t,"stack",{get:function(){return $e?n&&(n.get?n.get.apply(t):n.value):e.stack}})}),te(e),R(e),n&&Y()}}function R(e){var t=e._listeners;e._listeners=[];for(var n=0,o=t.length;n<o;++n)U(e,t[n]);var i=e._PSD;--i.ref||i.finalize(),0===st&&(++st,Qe(function(){0===--st&&X()},[]))}function U(e,t){if(null===e._state)return void e._listeners.push(t);var n=e._state?t.onFulfilled:t.onRejected;if(null===n)return(e._state?t.resolve:t.reject)(e._value);var o=t.psd;++o.ref,++st,Qe(V,[n,e,t])}function V(e,t,n){var o=at,i=n.psd;try{i!==o&&(at=i),nt=t;var a,r=t._value;t._state?a=e(r):(tt.length&&(tt=[]),a=e(r),tt.indexOf(r)===-1&&ne(t)),n.resolve(a)}catch(e){n.reject(e)}finally{i!==o&&(at=o),nt=null,0===--st&&X(),--i.ref||i.finalize()}}function W(e,t,o){if(t.length===o)return t;var i="";if(e._state===!1){var a,r,s=e._value;null!=s?(a=s.name||"Error",r=s.message||s,i=n(s,0)):(a=s,r=""),t.push(a+(r?": "+r:"")+i)}return _e&&(i=n(e._stackHolder,2),i&&t.indexOf(i)===-1&&t.push(i),e._prev&&W(e._prev,t,o)),t}function $(e,t){var n=t?t._numPrev+1:0;n<Ve&&(e._prev=t,e._numPrev=n)}function Z(){Q()&&Y()}function Q(){var e=Ye;return Ye=!1,Xe=!1,e}function Y(){var e,t,n;do for(;rt.length>0;)for(e=rt,rt=[],n=e.length,t=0;t<n;++t){var o=e[t];o[0].apply(null,o[1])}while(rt.length>0);Ye=!0,Xe=!0}function X(){var e=et;et=[],e.forEach(function(e){e._PSD.onunhandled.call(null,e._value,e)});for(var t=ut.slice(0),n=t.length;n;)t[--n]()}function ee(e){function t(){e(),ut.splice(ut.indexOf(t),1)}ut.push(t),++st,Qe(function(){0===--st&&X()},[])}function te(e){et.some(function(t){return t._value===e._value})||et.push(e)}function ne(e){for(var t=et.length;t;)if(et[--t]._value===e._value)return void et.splice(t,1)}function oe(e){console.warn("Unhandled rejection: "+(e.stack||e))}function ie(e){return new K(Ue,(!1),e)}function ae(e,t){var n=at;return function(){var o=Q(),i=at;try{return i!==n&&(at=n),e.apply(this,arguments)}catch(e){t&&t(e)}finally{i!==n&&(at=i),o&&Y()}}}function re(e,t,n,o){var i=at,a=Object.create(i);a.parent=i,a.ref=0,a.global=!1,++i.ref,a.finalize=function(){--this.parent.ref||this.parent.finalize()};var r=se(a,e,t,n,o);return 0===a.ref&&a.finalize(),r}function se(e,t,n,o,i){var a=at;try{return e!==a&&(at=e),t(n,o,i)}finally{e!==a&&(at=a)}}function ue(e,t){var n;try{n=t.onuncatched(e)}catch(e){}if(n!==!1)try{K.on.error.fire(e,t)}catch(e){}}function ce(e,n){function r(){tt.on("versionchange",function(e){e.newVersion>0?console.warn("Another connection wants to upgrade database '"+tt.name+"'. Closing db now to resume the upgrade."):console.warn("Another connection wants to delete database '"+tt.name+"'. Closing db now to resume the delete request."),tt.close()}),tt.on("blocked",function(e){!e.newVersion||e.newVersion<e.oldVersion?console.warn("Dexie.delete('"+tt.name+"') was blocked"):console.warn("Upgrade '"+tt.name+"' blocked by other connection holding version "+e.oldVersion/10)})}function l(e){this._cfg={version:e,storesSource:null,dbschema:{},tables:{},contentUpgrade:null},this.stores({})}function v(e,t,n){var o=tt._createTransaction(et,Ve,Re);o.create(t),o._completion.catch(n);var i=o._reject.bind(o);re(function(){at.trans=o,0===e?(Oe(Re).forEach(function(e){N(t,e,Re[e].primKey,Re[e].indexes)}),K.follow(function(){return tt.on.populate.fire(o)}).catch(i)):S(e,o,t).catch(i)})}function S(e,t,n){function o(){return i.length?K.resolve(i.shift()(t.idbtrans)).then(o):K.resolve()}var i=[],a=Ue.filter(function(t){return t._cfg.version===e})[0];if(!a)throw new Je.Upgrade("Dexie specification of currently installed DB version is missing");Re=tt._dbSchema=a._cfg.dbschema;var r=!1,s=Ue.filter(function(t){return t._cfg.version>e});return s.forEach(function(e){i.push(function(){var o=Re,i=e._cfg.dbschema;Me(o,n),Me(i,n),Re=tt._dbSchema=i;var a=C(o,i);if(a.add.forEach(function(e){N(n,e[0],e[1].primKey,e[1].indexes)}),a.change.forEach(function(e){if(e.recreate)throw new Je.Upgrade("Not yet support for changing primary key");var t=n.objectStore(e.name);e.add.forEach(function(e){G(t,e)}),e.change.forEach(function(e){t.deleteIndex(e.name),G(t,e)}),e.del.forEach(function(e){t.deleteIndex(e)})}),e._cfg.contentUpgrade)return r=!0,K.follow(function(){e._cfg.contentUpgrade(t)})}),i.push(function(t){if(!r||!gt){var n=e._cfg.dbschema;H(n,t)}})}),o().then(function(){D(Re,n)})}function C(e,t){var n={del:[],add:[],change:[]};for(var o in e)t[o]||n.del.push(o);for(o in t){var i=e[o],a=t[o];if(i){var r={name:o,def:a,recreate:!1,del:[],add:[],change:[]};if(i.primKey.src!==a.primKey.src)r.recreate=!0,n.change.push(r);else{var s=i.idxByName,u=a.idxByName;for(var c in s)u[c]||r.del.push(c);for(c in u){var l=s[c],h=u[c];l?l.src!==h.src&&r.change.push(h):r.add.push(h)}(r.del.length>0||r.add.length>0||r.change.length>0)&&n.change.push(r)}}else n.add.push([o,a])}return n}function N(e,t,n,o){var i=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return o.forEach(function(e){G(i,e)}),i}function D(e,t){Oe(e).forEach(function(n){t.db.objectStoreNames.contains(n)||N(t,n,e[n].primKey,e[n].indexes)})}function H(e,t){for(var n=0;n<t.db.objectStoreNames.length;++n){var o=t.db.objectStoreNames[n];null==e[o]&&t.db.deleteObjectStore(o)}}function G(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function J(e){return tt.on.error.fire(e)}function q(e,t,n){if(Ye||at.letThrough){var i=tt._createTransaction(e,t,Re);return i._promise(e,function(e,t){re(function(){at.trans=i,n(e,t,i)})}).then(function(e){return i._completion.then(function(){return e})})}if(!Qe){if(!Ke)return O(new Je.DatabaseClosed,J);tt.open().catch(o)}return nt.then(function(){return q(e,t,n)})}function R(e,t,n){this.name=e,this.schema=t,this.hook=We[e]?We[e].hook:F(null,{creating:[s,o],reading:[a,i],updating:[c,o],deleting:[u,o]}),this._collClass=n||Q}function U(e,t,n){R.call(this,e,t,n||X)}function V(e,t,n){return(n?pe:fe)(function(n){e.push(n),t&&t()})}function W(e,t,n,o,i){return new K(function(a,r){var s=n.length,u=s-1;if(0===s)return a();if(o){var c,l=pe(r),h=me(null);I(function(){for(var o=0;o<s;++o){c={onsuccess:null,onerror:null};var r=n[o];i.call(c,r[0],r[1],t);var d=e.delete(r[0]);d._hookCtx=c,d.onerror=l,o===u?d.onsuccess=me(a):d.onsuccess=h}},function(e){throw c.onerror&&c.onerror(e),e})}else for(var d=0;d<s;++d){var m=e.delete(n[d]);m.onerror=ae(fe(r)),d===u&&(m.onsuccess=ae(function(){return a()}))}}).uncaught(J)}function $(e,t,n,o){var i=this;this.db=tt,this.mode=e,this.storeNames=t,this.idbtrans=null,this.on=F(this,"complete","error","abort"),this.parent=o||null,this.active=!0,this._tables=null,this._reculock=0,this._blockedFuncs=[],this._psd=null,this._dbschema=n,this._resolve=null,this._reject=null,this._completion=new K(function(e,t){i._resolve=e,i._reject=t}).uncaught(J),this._completion.then(function(){i.on.complete.fire()},function(e){return i.on.error.fire(e),i.parent?i.parent._reject(e):i.active&&i.idbtrans&&i.idbtrans.abort(),i.active=!1,O(e)})}function Z(e,t,n){this._ctx={table:e,index:":id"===t?null:t,collClass:e._collClass,or:n}}function Q(e,t){var n=null,o=null;if(t)try{n=t()}catch(e){o=e}var i=e._ctx,a=i.table;this._ctx={table:a,index:i.index,isPrimKey:!i.index||a.schema.primKey.keyPath&&i.index===a.schema.primKey.name,range:n,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:o,or:i.or,valueMapper:a.hook.reading.fire}}function Y(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function X(){Q.apply(this,arguments)}function ee(e,t){return e._cfg.version-t._cfg.version}function te(e,t,n,o){t.forEach(function(t){var i=tt._tableFactory(n,o[t]);e.forEach(function(e){t in e||(e[t]=i)})})}function ne(e){e.forEach(function(e){for(var t in e)e[t]instanceof R&&delete e[t]})}function oe(e,t,n,o,i,a){var r=a?function(e,t,o){return n(a(e),t,o)}:n,s=ae(r,i);e.onerror||(e.onerror=fe(i)),t?e.onsuccess=x(function(){var n=e.result;if(n){var a=function(){n.continue()};t(n,function(e){a=e},o,i)&&s(n.value,n,function(e){a=e}),a()}else o()},i):e.onsuccess=x(function(){var t=e.result;if(t){var n=function(){t.continue()};s(t.value,t,function(e){n=e}),n()}else o()},i)}function ie(e){var t=[];return e.split(",").forEach(function(e){e=e.trim();var n=e.replace(/([&*]|\+\+)/g,""),o=/^\[/.test(n)?n.match(/^\[(.*)\]$/)[1].split("+"):n;t.push(new ye(n,o||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),Ae(o),/\./.test(e)))}),t}function se(e,t){return Ge.cmp(e,t)}function ue(e,t){return se(e,t)<0?e:t}function le(e,t){return se(e,t)>0?e:t}function xe(e,t){return Ge.cmp(e,t)}function Ie(e,t){return Ge.cmp(t,e)}function Te(e,t){return e<t?-1:e===t?0:1}function Ce(e,t){return e>t?-1:e===t?0:1}function Ee(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}function Pe(){if(tt.verno=$e.version/10,tt._dbSchema=Re={},Ve=b($e.objectStoreNames,0),0!==Ve.length){var e=$e.transaction(ke(Ve),"readonly");Ve.forEach(function(t){for(var n=e.objectStore(t),o=n.keyPath,i=o&&"string"==typeof o&&o.indexOf(".")!==-1,a=new ye(o,o||"",(!1),(!1),(!!n.autoIncrement),o&&"string"!=typeof o,i),r=[],s=0;s<n.indexNames.length;++s){var u=n.index(n.indexNames[s]);o=u.keyPath,i=o&&"string"==typeof o&&o.indexOf(".")!==-1;var c=new ye(u.name,o,(!!u.unique),(!!u.multiEntry),(!1),o&&"string"!=typeof o,i);r.push(c)}Re[t]=new we(t,a,r,{})}),te([We,$.prototype],Oe(Re),et,Re)}}function Me(e,t){for(var n=t.db.objectStoreNames,o=0;o<n.length;++o){var i=n[o],a=t.objectStore(i);Le="getAll"in a;for(var r=0;r<a.indexNames.length;++r){var s=a.indexNames[r],u=a.index(s).keyPath,c="string"==typeof u?u:"["+b(u).join("+")+"]";if(e[i]){var l=e[i].idxByName[c];l&&(l.name=s)}}}}function je(e){tt.on("blocked").fire(e),ft.filter(function(e){return e.name===tt.name&&e!==tt&&!e._vcFired}).map(function(t){return t.on("versionchange").fire(e)})}var Be,De,Le,ze=ce.dependencies,He=d({addons:ce.addons,autoOpen:!0,indexedDB:ze.indexedDB,IDBKeyRange:ze.IDBKeyRange},n),Fe=He.addons,Ke=He.autoOpen,Ge=He.indexedDB,qe=He.IDBKeyRange,Re=this._dbSchema={},Ue=[],Ve=[],We={},$e=null,Ze=null,Qe=!1,Ye=!1,Xe="readonly",et="readwrite",tt=this,nt=new K(function(e){Be=e}),ot=new K(function(e,t){De=t}),it=!0,rt=!!Se(Ge);this.version=function(e){if($e||Qe)throw new Je.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=Ue.filter(function(t){return t._cfg.version===e})[0];return t?t:(t=new l(e),Ue.push(t),Ue.sort(ee),t)},d(l.prototype,{stores:function(e){this._cfg.storesSource=this._cfg.storesSource?d(this._cfg.storesSource,e):e;var t={};Ue.forEach(function(e){d(t,e._cfg.storesSource)});var n=this._cfg.dbschema={};return this._parseStoresSpec(t,n),Re=tt._dbSchema=n,ne([We,tt,$.prototype]),te([We,tt,$.prototype,this._cfg.tables],Oe(n),et,n),Ve=Oe(n),this},upgrade:function(e){var t=this;return yt(function(){e(tt._createTransaction(et,Oe(t._cfg.dbschema),t._cfg.dbschema))}),this._cfg.contentUpgrade=e,this},_parseStoresSpec:function(e,t){Oe(e).forEach(function(n){if(null!==e[n]){var o={},i=ie(e[n]),a=i.shift();if(a.multi)throw new Je.Schema("Primary key cannot be multi-valued");a.keyPath&&T(o,a.keyPath,a.auto?0:a.keyPath),i.forEach(function(e){if(e.auto)throw new Je.Schema("Only primary key can be marked as autoIncrement (++)");if(!e.keyPath)throw new Je.Schema("Index must have a name and cannot be an empty string");T(o,e.keyPath,e.compound?e.keyPath.map(function(){return""}):"")}),t[n]=new we(n,a,i,o)}})}}),this._allTables=We,this._tableFactory=function(e,t){return e===Xe?new R(t.name,t,Q):new U(t.name,t)},this._createTransaction=function(e,t,n,o){return new $(e,t,n,o)},this._whenReady=function(e){return new K(wt||Ye||at.letThrough?e:function(t,n){if(!Qe){if(!Ke)return void n(new Je.DatabaseClosed);tt.open().catch(o)}nt.then(function(){e(t,n)})}).uncaught(J)},this.verno=0,this.open=function(){if(Qe||$e)return nt.then(function(){return Ze?O(Ze,J):tt});_e&&(ot._stackHolder=t()),Qe=!0,Ze=null,Ye=!1;var n=Be,o=null;return K.race([ot,new K(function(t,n){if(w(function(){return t()}),Ue.length>0&&(it=!1),!Ge)throw new Je.MissingAPI("indexedDB API not found. If using IE10+, make sure to run your code on a server URL (not locally). If using old Safari versions, make sure to include indexedDB polyfill.");var i=it?Ge.open(e):Ge.open(e,Math.round(10*tt.verno));if(!i)throw new Je.MissingAPI("IndexedDB API not available");i.onerror=ae(fe(n)),i.onblocked=ae(je),i.onupgradeneeded=ae(function(t){if(o=i.transaction,it&&!tt._allowEmptyDB){i.onerror=ge,o.abort(),i.result.close();var a=Ge.deleteDatabase(e);a.onsuccess=a.onerror=ae(function(){n(new Je.NoSuchDatabase("Database "+e+" doesnt exist"))})}else{o.onerror=ae(fe(n));var r=t.oldVersion>Math.pow(2,62)?0:t.oldVersion;v(r/10,o,n,i)}},n),i.onsuccess=ae(function(){if(o=null,$e=i.result,ft.push(tt),it)Pe();else if($e.objectStoreNames.length>0)try{Me(Re,$e.transaction(ke($e.objectStoreNames),Xe))}catch(e){}$e.onversionchange=ae(function(e){tt._vcFired=!0,tt.on("versionchange").fire(e)}),rt||ve(function(t){if(t.indexOf(e)===-1)return t.push(e)}),t()},n)})]).then(function(){return ce.vip(tt.on.ready.fire)}).then(function(){return Qe=!1,tt}).catch(function(e){try{o&&o.abort()}catch(e){}return Qe=!1,tt.close(),Ze=e,O(Ze,J)}).finally(function(){Ye=!0,n()})},this.close=function(){var e=ft.indexOf(tt);if(e>=0&&ft.splice(e,1),$e){try{$e.close()}catch(e){}$e=null}Ke=!1,Ze=new Je.DatabaseClosed,Qe&&De(Ze),nt=new K(function(e){Be=e}),ot=new K(function(e,t){De=t})},this.delete=function(){var t=arguments.length>0;return new K(function(n,o){function i(){tt.close();var t=Ge.deleteDatabase(e);t.onsuccess=ae(function(){rt||ve(function(t){var n=t.indexOf(e);if(n>=0)return t.splice(n,1)}),n()}),t.onerror=ae(fe(o)),t.onblocked=je}if(t)throw new Je.InvalidArgument("Arguments not allowed in db.delete()");Qe?nt.then(i):i()}).uncaught(J)},this.backendDB=function(){return $e},this.isOpen=function(){return null!==$e},this.hasFailed=function(){return null!==Ze},this.dynamicallyOpened=function(){return it},this.name=e,p(this,"tables",{get:function(){return Oe(We).map(function(e){return We[e]})}}),this.on=F(this,"error","populate","blocked","versionchange",{ready:[h,o]}),this.on.ready.subscribe=y(this.on.ready.subscribe,function(e){return function(t,n){ce.vip(function(){Ye?(K.resolve().then(t),n&&e(t)):(e(t),n||e(function e(){tt.on.ready.unsubscribe(t),tt.on.ready.unsubscribe(e)}))})}}),yt(function(){tt.on("populate").fire(tt._createTransaction(et,Ve,Re)),tt.on("error").fire(new Error)}),this.transaction=function(e,t,n){function o(t){var o=at;t(K.resolve().then(function(){return re(function(){at.transless=at.transless||o;var t=tt._createTransaction(e,c,Re,s);at.trans=t,s?t.idbtrans=s.idbtrans:t.create();var i=c.map(function(e){return t.tables[e]});i.push(t);var a;return K.follow(function(){if(a=n.apply(t,i))if("function"==typeof a.next&&"function"==typeof a.throw)a=be(a);else if("function"==typeof a.then&&!m(a,"_PSD"))throw new Je.IncompatiblePromise("Incompatible Promise returned from transaction scope (read more at http://tinyurl.com/znyqjqc). Transaction scope: "+n.toString())}).uncaught(J).then(function(){return s&&t._resolve(),t._completion}).then(function(){return a}).catch(function(e){return t._reject(e),O(e)})})}))}var i=arguments.length;if(i<2)throw new Je.InvalidArgument("Too few arguments");for(var a=new Array(i-1);--i;)a[i-1]=arguments[i];n=a.pop();var r=B(a),s=at.trans;s&&s.db===tt&&e.indexOf("!")===-1||(s=null);var u=e.indexOf("?")!==-1;e=e.replace("!","").replace("?","");try{var c=r.map(function(e){var t=e instanceof R?e.name:e;if("string"!=typeof t)throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return t});if("r"==e||e==Xe)e=Xe;else{if("rw"!=e&&e!=et)throw new Je.InvalidArgument("Invalid transaction mode: "+e);e=et}if(s){if(s.mode===Xe&&e===et){if(!u)throw new Je.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");s=null}s&&c.forEach(function(e){if(!m(s.tables,e)){if(!u)throw new Je.SubTransaction("Table "+e+" not included in parent transaction.");s=null}})}}catch(e){return s?s._promise(null,function(t,n){n(e)}):O(e,J)}return s?s._promise(e,o,"lock"):tt._whenReady(o)},this.table=function(e){if(wt&&it)return new U(e);if(!m(We,e))throw new Je.InvalidTable("Table "+e+" does not exist");return We[e]},f(R.prototype,{_trans:function(e,t,n){var o=at.trans;return o&&o.db===tt?o._promise(e,t,n):q(e,[this.name],t)},_idbstore:function(e,t,n){function o(e,n,o){t(e,n,o.idbtrans.objectStore(a),o)}if(wt)return new K(t);var i=at.trans,a=this.name;return i&&i.db===tt?i._promise(e,o,n):q(e,[this.name],o)},get:function(e,t){var n=this;return this._idbstore(Xe,function(t,o,i){wt&&t(n.schema.instanceTemplate);var a=i.get(e);a.onerror=fe(o),a.onsuccess=function(){t(n.hook.reading.fire(a.result))}}).then(t)},where:function(e){return new Z(this,e)},count:function(e){return this.toCollection().count(e)},offset:function(e){return this.toCollection().offset(e)},limit:function(e){return this.toCollection().limit(e)},reverse:function(){return this.toCollection().reverse()},filter:function(e){return this.toCollection().and(e)},each:function(e){return this.toCollection().each(e)},toArray:function(e){return this.toCollection().toArray(e)},orderBy:function(e){return new this._collClass(new Z(this,e))},toCollection:function(){return new this._collClass(new Z(this))},mapToClass:function(e,t){this.schema.mappedClass=e;var n=Object.create(e.prototype);t&&he(n,t),this.schema.instanceTemplate=n;var o=function(t){if(!t)return t;var n=Object.create(e.prototype);for(var o in t)m(t,o)&&(n[o]=t[o]);return n};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=o,this.hook("reading",o),e},defineClass:function(e){return this.mapToClass(ce.defineClass(e),e)}}),g(U).from(R).extend({bulkDelete:function(e){return this.hook.deleting.fire===o?this._idbstore(et,function(t,n,i,a){t(W(i,a,e,!1,o))}):this.where(":id").anyOf(e).delete().then(function(){})},bulkPut:function(e,t){var n=this;return this._idbstore(et,function(i,a,r){if(!r.keyPath&&!n.schema.primKey.auto&&!t)throw new Je.InvalidArgument("bulkPut() with non-inbound keys requires keys array in second argument");if(r.keyPath&&t)throw new Je.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(t&&t.length!==e.length)throw new Je.InvalidArgument("Arguments objects and keys must have the same length");if(0===e.length)return i();var s,u,c=function(e){0===l.length?i(e):a(new z(n.name+".bulkPut(): "+l.length+" of "+h+" operations failed",l))},l=[],h=e.length,d=n;if(n.hook.creating.fire===o&&n.hook.updating.fire===o){u=V(l);for(var m=0,f=e.length;m<f;++m)s=t?r.put(e[m],t[m]):r.put(e[m]),s.onerror=u;s.onerror=V(l,c),s.onsuccess=de(c)}else{var p=t||r.keyPath&&e.map(function(e){return A(e,r.keyPath)}),g=p&&_(p,function(t,n){return null!=t&&[t,e[n]]}),v=p?d.where(":id").anyOf(p.filter(function(e){return null!=e})).modify(function(){this.value=g[this.primKey],g[this.primKey]=null}).catch(L,function(e){l=e.failures}).then(function(){for(var n=[],o=t&&[],i=p.length-1;i>=0;--i){var a=p[i];(null==a||g[a])&&(n.push(e[i]),t&&o.push(a),null!=a&&(g[a]=null))}return n.reverse(),t&&o.reverse(),d.bulkAdd(n,o)}).then(function(e){var t=p[p.length-1];return null!=t?t:e}):d.bulkAdd(e);v.then(c).catch(z,function(e){l=l.concat(e.failures),c()}).catch(a)}},"locked")},bulkAdd:function(e,t){var n=this,i=this.hook.creating.fire;return this._idbstore(et,function(a,r,s,u){function c(e){0===m.length?a(e):r(new z(n.name+".bulkAdd(): "+m.length+" of "+f+" operations failed",m))}if(!s.keyPath&&!n.schema.primKey.auto&&!t)throw new Je.InvalidArgument("bulkAdd() with non-inbound keys requires keys array in second argument");if(s.keyPath&&t)throw new Je.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(t&&t.length!==e.length)throw new Je.InvalidArgument("Arguments objects and keys must have the same length");if(0===e.length)return a();var l,h,d,m=[],f=e.length;if(i!==o){var p,g=s.keyPath;h=V(m,null,!0),d=me(null),I(function(){for(var n=0,o=e.length;n<o;++n){p={onerror:null,onsuccess:null};var a=t&&t[n],r=e[n],c=t?a:g?A(r,g):void 0,m=i.call(p,c,r,u);null==c&&null!=m&&(g?(r=P(r),T(r,g,m)):a=m),l=null!=a?s.add(r,a):s.add(r),l._hookCtx=p,n<o-1&&(l.onerror=h,p.onsuccess&&(l.onsuccess=d))}},function(e){throw p.onerror&&p.onerror(e),e}),l.onerror=V(m,c,!0),l.onsuccess=me(c)}else{h=V(m);for(var v=0,b=e.length;v<b;++v)l=t?s.add(e[v],t[v]):s.add(e[v]),l.onerror=h;l.onerror=V(m,c),l.onsuccess=de(c)}})},add:function(e,t){var n=this.hook.creating.fire;return this._idbstore(et,function(i,a,r,s){var u={onsuccess:null,onerror:null};if(n!==o){var c=null!=t?t:r.keyPath?A(e,r.keyPath):void 0,l=n.call(u,c,e,s);null==c&&null!=l&&(r.keyPath?T(e,r.keyPath,l):t=l)}try{var h=null!=t?r.add(e,t):r.add(e);h._hookCtx=u,h.onerror=pe(a),h.onsuccess=me(function(t){var n=r.keyPath;n&&T(e,n,t),i(t)})}catch(e){throw u.onerror&&u.onerror(e),e}})},put:function(e,t){var n=this,i=this.hook.creating.fire,a=this.hook.updating.fire;return i!==o||a!==o?this._trans(et,function(o,i,a){var r=void 0!==t?t:n.schema.primKey.keyPath&&A(e,n.schema.primKey.keyPath);null==r?a.tables[n.name].add(e).then(o,i):(a._lock(),e=P(e),a.tables[n.name].where(":id").equals(r).modify(function(){this.value=e}).then(function(o){return 0===o?a.tables[n.name].add(e,t):r}).finally(function(){a._unlock()}).then(o,i))}):this._idbstore(et,function(n,o,i){var a=void 0!==t?i.put(e,t):i.put(e);a.onerror=fe(o),a.onsuccess=function(t){var o=i.keyPath;o&&T(e,o,t.target.result),n(a.result)}})},delete:function(e){return this.hook.deleting.subscribers.length?this.where(":id").equals(e).delete():this._idbstore(et,function(t,n,o){var i=o.delete(e);i.onerror=fe(n),i.onsuccess=function(){t(i.result)}})},clear:function(){return this.hook.deleting.subscribers.length?this.toCollection().delete():this._idbstore(et,function(e,t,n){var o=n.clear();o.onerror=fe(t),o.onsuccess=function(){e(o.result)}})},update:function(e,t){if("object"!=typeof t||Ae(t))throw new Je.InvalidArgument("Modifications must be an object.");if("object"!=typeof e||Ae(e))return this.where(":id").equals(e).modify(t);Oe(t).forEach(function(n){T(e,n,t[n])});var n=A(e,this.schema.primKey.keyPath);return void 0===n?O(new Je.InvalidArgument("Given object does not contain its primary key"),J):this.where(":id").equals(n).modify(t)}}),f($.prototype,{_lock:function(){return k(!at.global),++this._reculock,1!==this._reculock||at.global||(at.lockOwnerFor=this),this},_unlock:function(){if(k(!at.global),0===--this._reculock)for(at.global||(at.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{e()}catch(e){}}return this},_locked:function(){return this._reculock&&at.lockOwnerFor!==this},create:function(e){var t=this;if(k(!this.idbtrans),!e&&!$e)switch(Ze&&Ze.name){case"DatabaseClosedError":throw new Je.DatabaseClosed(Ze);case"MissingAPIError":throw new Je.MissingAPI(Ze.message,Ze);default:throw new Je.OpenFailed(Ze)}if(!this.active)throw new Je.TransactionInactive;return k(null===this._completion._state),e=this.idbtrans=e||$e.transaction(ke(this.storeNames),this.mode),e.onerror=ae(function(n){ge(n),t._reject(e.error)}),e.onabort=ae(function(e){ge(e),t.active&&t._reject(new Je.Abort),t.active=!1,t.on("abort").fire(e)}),e.oncomplete=ae(function(){t.active=!1,t._resolve()}),this},_promise:function(e,t,n){var o=this;return re(function(){var i;return o._locked()?i=new K(function(i,a){o._blockedFuncs.push(function(){o._promise(e,t,n).then(i,a)})}):(i=o.active?new K(function(i,a){if(e===et&&o.mode!==et)throw new Je.ReadOnly("Transaction is readonly");!o.idbtrans&&e&&o.create(),n&&o._lock(),t(i,a,o)}):O(new Je.TransactionInactive),o.active&&n&&i.finally(function(){o._unlock()})),i._lib=!0,i.uncaught(J)})},abort:function(){this.active&&this._reject(new Je.Abort),this.active=!1},tables:{get:function(){return this._tables?this._tables:this._tables=_(this.storeNames,function(e){return[e,We[e]]})}},complete:function(e){return this.on("complete",e)},error:function(e){return this.on("error",e)},table:function(e){if(this.storeNames.indexOf(e)===-1)throw new Je.InvalidTable("Table "+e+" not in transaction");
return We[e]}}),f(Z.prototype,function(){function e(e,t,n){var o=e instanceof Z?new e._ctx.collClass(e):e;return o._ctx.error=n?new n(t):new TypeError(t),o}function t(e){return new e._ctx.collClass(e,function(){return qe.only("")}).limit(0)}function n(e){return"next"===e?function(e){return e.toUpperCase()}:function(e){return e.toLowerCase()}}function o(e){return"next"===e?function(e){return e.toLowerCase()}:function(e){return e.toUpperCase()}}function i(e,t,n,o,i,a){for(var r=Math.min(e.length,o.length),s=-1,u=0;u<r;++u){var c=t[u];if(c!==o[u])return i(e[u],n[u])<0?e.substr(0,u)+n[u]+n.substr(u+1):i(e[u],o[u])<0?e.substr(0,u)+o[u]+n.substr(u+1):s>=0?e.substr(0,s)+t[s]+n.substr(s+1):null;i(e[u],c)<0&&(s=u)}return r<o.length&&"next"===a?e+n.substr(e.length):r<e.length&&"prev"===a?e.substr(0,n.length):s<0?null:e.substr(0,s)+o[s]+n.substr(s+1)}function a(t,a,r,s){function u(e){c=n(e),l=o(e),h="next"===e?Te:Ce;var t=r.map(function(e){return{lower:l(e),upper:c(e)}}).sort(function(e,t){return h(e.lower,t.lower)});d=t.map(function(e){return e.upper}),m=t.map(function(e){return e.lower}),f=e,p="next"===e?"":s}var c,l,h,d,m,f,p,g=r.length;if(!r.every(function(e){return"string"==typeof e}))return e(t,mt);u("next");var v=new t._ctx.collClass(t,function(){return qe.bound(d[0],m[g-1]+s)});v._ondirectionchange=function(e){u(e)};var b=0;return v._addAlgorithm(function(e,t,n){var o=e.key;if("string"!=typeof o)return!1;var r=l(o);if(a(r,m,b))return!0;for(var s=null,u=b;u<g;++u){var c=i(o,r,d[u],m[u],h,f);null===c&&null===s?b=u+1:(null===s||h(s,c)>0)&&(s=c)}return t(null!==s?function(){e.continue(s+p)}:n),!1}),v}return{between:function(n,o,i,a){i=i!==!1,a=a===!0;try{return se(n,o)>0||0===se(n,o)&&(i||a)&&(!i||!a)?t(this):new this._ctx.collClass(this,function(){return qe.bound(n,o,!i,!a)})}catch(t){return e(this,dt)}},equals:function(e){return new this._ctx.collClass(this,function(){return qe.only(e)})},above:function(e){return new this._ctx.collClass(this,function(){return qe.lowerBound(e,!0)})},aboveOrEqual:function(e){return new this._ctx.collClass(this,function(){return qe.lowerBound(e)})},below:function(e){return new this._ctx.collClass(this,function(){return qe.upperBound(e,!0)})},belowOrEqual:function(e){return new this._ctx.collClass(this,function(){return qe.upperBound(e)})},startsWith:function(t){return"string"!=typeof t?e(this,mt):this.between(t,t+lt,!0,!0)},startsWithIgnoreCase:function(e){return""===e?this.startsWith(e):a(this,function(e,t){return 0===e.indexOf(t[0])},[e],lt)},equalsIgnoreCase:function(e){return a(this,function(e,t){return e===t[0]},[e],"")},anyOfIgnoreCase:function(){var e=j.apply(Ne,arguments);return 0===e.length?t(this):a(this,function(e,t){return t.indexOf(e)!==-1},e,"")},startsWithAnyOfIgnoreCase:function(){var e=j.apply(Ne,arguments);return 0===e.length?t(this):a(this,function(e,t){return t.some(function(t){return 0===e.indexOf(t)})},e,lt)},anyOf:function(){var n=j.apply(Ne,arguments),o=xe;try{n.sort(o)}catch(t){return e(this,dt)}if(0===n.length)return t(this);var i=new this._ctx.collClass(this,function(){return qe.bound(n[0],n[n.length-1])});i._ondirectionchange=function(e){o="next"===e?xe:Ie,n.sort(o)};var a=0;return i._addAlgorithm(function(e,t,i){for(var r=e.key;o(r,n[a])>0;)if(++a,a===n.length)return t(i),!1;return 0===o(r,n[a])||(t(function(){e.continue(n[a])}),!1)}),i},notEqual:function(e){return this.inAnyRange([[-(1/0),e],[e,ht]],{includeLowers:!1,includeUppers:!1})},noneOf:function(){var t=j.apply(Ne,arguments);if(0===t.length)return new this._ctx.collClass(this);try{t.sort(xe)}catch(t){return e(this,dt)}var n=t.reduce(function(e,t){return e?e.concat([[e[e.length-1][1],t]]):[[-(1/0),t]]},null);return n.push([t[t.length-1],ht]),this.inAnyRange(n,{includeLowers:!1,includeUppers:!1})},inAnyRange:function(n,o){function i(e,t){for(var n=0,o=e.length;n<o;++n){var i=e[n];if(se(t[0],i[1])<0&&se(t[1],i[0])>0){i[0]=ue(i[0],t[0]),i[1]=le(i[1],t[1]);break}}return n===o&&e.push(t),e}function a(e,t){return h(e[0],t[0])}function r(e){return!m(e)&&!f(e)}var s=this._ctx;if(0===n.length)return t(this);if(!n.every(function(e){return void 0!==e[0]&&void 0!==e[1]&&xe(e[0],e[1])<=0}))return e(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",Je.InvalidArgument);var u,c=!o||o.includeLowers!==!1,l=o&&o.includeUppers===!0,h=xe;try{u=n.reduce(i,[]),u.sort(a)}catch(t){return e(this,dt)}var d=0,m=l?function(e){return xe(e,u[d][1])>0}:function(e){return xe(e,u[d][1])>=0},f=c?function(e){return Ie(e,u[d][0])>0}:function(e){return Ie(e,u[d][0])>=0},p=m,g=new s.collClass(this,function(){return qe.bound(u[0][0],u[u.length-1][1],!c,!l)});return g._ondirectionchange=function(e){"next"===e?(p=m,h=xe):(p=f,h=Ie),u.sort(a)},g._addAlgorithm(function(e,t,n){for(var o=e.key;p(o);)if(++d,d===u.length)return t(n),!1;return!!r(o)||0!==se(o,u[d][1])&&0!==se(o,u[d][0])&&(t(function(){h===xe?e.continue(u[d][0]):e.continue(u[d][1])}),!1)}),g},startsWithAnyOf:function(){var n=j.apply(Ne,arguments);return n.every(function(e){return"string"==typeof e})?0===n.length?t(this):this.inAnyRange(n.map(function(e){return[e,e+lt]})):e(this,"startsWithAnyOf() only works with strings")}}}),f(Q.prototype,function(){function e(e,t){e.filter=Ee(e.filter,t)}function t(e,t,n){var o=e.replayFilter;e.replayFilter=o?function(){return Ee(o(),t())}:t,e.justLimit=n&&!o}function n(e,t){e.isMatch=Ee(e.isMatch,t)}function o(e,t){if(e.isPrimKey)return t;var n=e.table.schema.idxByName[e.index];if(!n)throw new Je.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return t.index(n.name)}function a(e,t){var n=o(e,t);return e.keysOnly&&"openKeyCursor"in n?n.openKeyCursor(e.range||null,e.dir+e.unique):n.openCursor(e.range||null,e.dir+e.unique)}function r(e,t,n,o,i){var r=e.replayFilter?Ee(e.filter,e.replayFilter()):e.filter;e.or?function(){function s(){2===++l&&n()}function u(e,n,i){if(!r||r(n,i,s,o)){var a=n.primaryKey.toString();m(c,a)||(c[a]=!0,t(e,n,i))}}var c={},l=0;e.or._iterate(u,s,o,i),oe(a(e,i),e.algorithm,u,s,o,!e.keysOnly&&e.valueMapper)}():oe(a(e,i),Ee(e.algorithm,r),t,n,o,!e.keysOnly&&e.valueMapper)}function s(e){return e.table.schema.instanceTemplate}return{_read:function(e,t){var n=this._ctx;return n.error?n.table._trans(null,function(e,t){t(n.error)}):n.table._idbstore(Xe,e).then(t)},_write:function(e){var t=this._ctx;return t.error?t.table._trans(null,function(e,n){n(t.error)}):t.table._idbstore(et,e,"locked")},_addAlgorithm:function(e){var t=this._ctx;t.algorithm=Ee(t.algorithm,e)},_iterate:function(e,t,n,o){return r(this._ctx,e,t,n,o)},clone:function(e){var t=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return e&&d(n,e),t._ctx=n,t},raw:function(){return this._ctx.valueMapper=null,this},each:function(e){var t=this._ctx;if(wt){var n=s(t),o=t.table.schema.primKey.keyPath,i=A(n,t.index?t.table.schema.idxByName[t.index].keyPath:o),a=A(n,o);e(n,{key:i,primaryKey:a})}return this._read(function(n,o,i){r(t,e,n,o,i)})},count:function(e){if(wt)return K.resolve(0).then(e);var t=this._ctx;if(Y(t,!0))return this._read(function(e,n,i){var a=o(t,i),r=t.range?a.count(t.range):a.count();r.onerror=fe(n),r.onsuccess=function(n){e(Math.min(n.target.result,t.limit))}},e);var n=0;return this._read(function(e,o,i){r(t,function(){return++n,!1},function(){e(n)},o,i)},e)},sortBy:function(e,t){function n(e,t){return t?n(e[i[t]],t-1):e[a]}function o(e,t){var o=n(e,r),i=n(t,r);return o<i?-s:o>i?s:0}var i=e.split(".").reverse(),a=i[0],r=i.length-1,s="next"===this._ctx.dir?1:-1;return this.toArray(function(e){return e.sort(o)}).then(t)},toArray:function(e){var t=this._ctx;return this._read(function(e,n,a){if(wt&&e([s(t)]),Le&&"next"===t.dir&&Y(t,!0)&&t.limit>0){var u=t.table.hook.reading.fire,c=o(t,a),l=t.limit<1/0?c.getAll(t.range,t.limit):c.getAll(t.range);l.onerror=fe(n),l.onsuccess=u===i?de(e):ae(de(function(t){e(t.map(u))}))}else{var h=[];r(t,function(e){h.push(e)},function(){e(h)},n,a)}},e)},offset:function(e){var n=this._ctx;return e<=0?this:(n.offset+=e,Y(n)?t(n,function(){var t=e;return function(e,n){return 0===t||(1===t?(--t,!1):(n(function(){e.advance(t),t=0}),!1))}}):t(n,function(){var t=e;return function(){return--t<0}}),this)},limit:function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),t(this._ctx,function(){var t=e;return function(e,n,o){return--t<=0&&n(o),t>=0}},!0),this},until:function(t,n){var o=this._ctx;return wt&&t(s(o)),e(this._ctx,function(e,o,i){return!t(e.value)||(o(i),n)}),this},first:function(e){return this.limit(1).toArray(function(e){return e[0]}).then(e)},last:function(e){return this.reverse().first(e)},filter:function(t){return wt&&t(s(this._ctx)),e(this._ctx,function(e){return t(e.value)}),n(this._ctx,t),this},and:function(e){return this.filter(e)},or:function(e){return new Z(this._ctx.table,e,this)},reverse:function(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},desc:function(){return this.reverse()},eachKey:function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(t,n){e(n.key,n)})},eachUniqueKey:function(e){return this._ctx.unique="unique",this.eachKey(e)},eachPrimaryKey:function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(t,n){e(n.primaryKey,n)})},keys:function(e){var t=this._ctx;t.keysOnly=!t.isMatch;var n=[];return this.each(function(e,t){n.push(t.key)}).then(function(){return n}).then(e)},primaryKeys:function(e){var t=this._ctx;if(Le&&"next"===t.dir&&Y(t,!0)&&t.limit>0)return this._read(function(e,n,i){var a=o(t,i),r=t.limit<1/0?a.getAllKeys(t.range,t.limit):a.getAllKeys(t.range);r.onerror=fe(n),r.onsuccess=de(e)}).then(e);t.keysOnly=!t.isMatch;var n=[];return this.each(function(e,t){n.push(t.primaryKey)}).then(function(){return n}).then(e)},uniqueKeys:function(e){return this._ctx.unique="unique",this.keys(e)},firstKey:function(e){return this.limit(1).keys(function(e){return e[0]}).then(e)},lastKey:function(e){return this.reverse().firstKey(e)},distinct:function(){var t=this._ctx,n=t.index&&t.table.schema.idxByName[t.index];if(!n||!n.multi)return this;var o={};return e(this._ctx,function(e){var t=e.primaryKey.toString(),n=m(o,t);return o[t]=!0,!n}),this}}}),g(X).from(Q).extend({modify:function(e){var t=this,n=this._ctx,i=n.table.hook,a=i.updating.fire,r=i.deleting.fire;return wt&&"function"==typeof e&&e.call({value:n.table.schema.instanceTemplate},n.table.schema.instanceTemplate),this._write(function(n,i,s,u){function c(e,t){function n(e){return k.push(e),S.push(o.primKey),h(),!0}_=t.primaryKey;var o={primKey:t.primaryKey,value:e,onsuccess:null,onerror:null};if(f.call(o,e,o)!==!1){var i=!m(o,"value");++b,I(function(){var e=i?t.delete():t.update(o.value);e._hookCtx=o,e.onerror=pe(n),e.onsuccess=me(function(){++y,h()})},n)}else o.onsuccess&&o.onsuccess(o.value)}function l(e){return e&&(k.push(e),S.push(_)),i(new L("Error modifying one or more objects",k,y,S))}function h(){w&&y+k.length===b&&(k.length>0?l():n(y))}var f;if("function"==typeof e)f=a===o&&r===o?e:function(t){var n=P(t);if(e.call(this,t,this)===!1)return!1;if(m(this,"value")){var o=M(n,this.value),i=a.call(this,o,this.primKey,n,u);i&&(t=this.value,Oe(i).forEach(function(e){T(t,e,i[e])}))}else r.call(this,this.primKey,t,u)};else if(a===o){var p=Oe(e),g=p.length;f=function(t){for(var n=!1,o=0;o<g;++o){var i=p[o],a=e[i];A(t,i)!==a&&(T(t,i,a),n=!0)}return n}}else{var v=e;e=E(v),f=function(t){var n=!1,o=a.call(this,e,this.primKey,P(t),u);return o&&d(e,o),Oe(e).forEach(function(o){var i=e[o];A(t,o)!==i&&(T(t,o,i),n=!0)}),o&&(e=E(v)),n}}var b=0,y=0,w=!1,k=[],S=[],_=null;t.clone().raw()._iterate(c,function(){w=!0,h()},l,s)})},delete:function(){var e=this,t=this._ctx,n=t.range,i=t.table.hook.deleting.fire,a=i!==o;if(!a&&Y(t)&&(t.isPrimKey&&!vt||!n))return this._write(function(e,t,o){var i=fe(t),a=n?o.count(n):o.count();a.onerror=i,a.onsuccess=function(){var r=a.result;I(function(){var t=n?o.delete(n):o.clear();t.onerror=i,t.onsuccess=function(){return e(r)}},function(e){return t(e)})}});var r=a?2e3:1e4;return this._write(function(n,o,s,u){var c=0,l=e.clone({keysOnly:!t.isMatch&&!a}).distinct().limit(r).raw(),h=[],d=function(){return l.each(a?function(e,t){h.push([t.primaryKey,t.value])}:function(e,t){h.push(t.primaryKey)}).then(function(){return a?h.sort(function(e,t){return xe(e[0],t[0])}):h.sort(xe),W(s,u,h,a,i)}).then(function(){var e=h.length;return c+=e,h=[],e<r?c:d()})};n(d())})}}),d(this,{Collection:Q,Table:R,Transaction:$,Version:l,WhereClause:Z,WriteableCollection:X,WriteableTable:U}),r(),Fe.forEach(function(e){e(tt)})}function le(e){if("function"==typeof e)return new e;if(Ae(e))return[le(e[0])];if(e&&"object"==typeof e){var t={};return he(t,e),t}return e}function he(e,t){return Oe(t).forEach(function(n){var o=le(t[n]);e[n]=o}),e}function de(e){return function(t){e(t.target.result)}}function me(e){return ae(function(t){var n=t.target,o=n.result,i=n._hookCtx,a=i&&i.onsuccess;a&&a(o),e&&e(o)},e)}function fe(e){return function(t){return ge(t),e(t.target.error),!1}}function pe(e){return ae(function(t){var n=t.target,o=n.error,i=n._hookCtx,a=i&&i.onerror;return a&&a(o),ge(t),e(o),!1})}function ge(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}function ve(e){var t,n=ce.dependencies.localStorage;if(!n)return e([]);try{t=JSON.parse(n.getItem("Dexie.DatabaseNames")||"[]")}catch(e){t=[]}e(t)&&n.setItem("Dexie.DatabaseNames",JSON.stringify(t))}function be(e){function t(e){return function(t){var n=e(t),o=n.value;return n.done?o:o&&"function"==typeof o.then?o.then(i,a):Ae(o)?K.all(o).then(i,a):i(o)}}var n=function(t){return e.next(t)},o=function(t){return e.throw(t)},i=t(n),a=t(o);return t(n)()}function ye(e,t,n,o,i,a,r){this.name=e,this.keyPath=t,this.unique=n,this.multi=o,this.auto=i,this.compound=a,this.dotted=r;var s="string"==typeof t?t:t&&"["+[].join.call(t,"+")+"]";this.src=(n?"&":"")+(o?"*":"")+(i?"++":"")+s}function we(e,t,n,o){this.name=e,this.primKey=t||new ye,this.indexes=n||[new ye],this.instanceTemplate=o,this.mappedClass=null,this.idxByName=_(n,function(e){return[e.name,e]})}function ke(e){return 1===e.length?e[0]:e}function Se(e){var t=e&&(e.getDatabaseNames||e.webkitGetDatabaseNames);return t&&t.bind(e)}var _e="undefined"!=typeof location&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href),xe=function(){return!0},Ie=!new Error("").stack,Oe=Object.keys,Ae=Array.isArray,Te="undefined"!=typeof self?self:"undefined"!=typeof window?window:global,Ce=Object.getPrototypeOf,Ee={}.hasOwnProperty,Pe=Object.getOwnPropertyDescriptor,Me=[].slice,je="undefined"!=typeof Symbol&&Symbol.iterator,Be=je?function(e){var t;return null!=e&&(t=e[je])&&t.apply(e)}:function(){return null},Ne={},De=[].concat,Le=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","IncompatiblePromise"],ze=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],He=Le.concat(ze),Fe={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed"};g(N).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+n(this._e,2))}},toString:function(){return this.name+": "+this.message}}),g(L).from(N),g(z).from(N);var Ke=He.reduce(function(e,t){return e[t]=t+"Error",e},{}),Ge=N,Je=He.reduce(function(e,n){function o(e,o){this._e=t(),this.name=i,e?"string"==typeof e?(this.message=e,this.inner=o||null):"object"==typeof e&&(this.message=e.name+" "+e.message,this.inner=e):(this.message=Fe[n]||i,this.inner=null)}var i=n+"Error";return g(o).from(Ge),e[n]=o,e},{});Je.Syntax=SyntaxError,Je.Type=TypeError,Je.Range=RangeError;var qe=ze.reduce(function(e,t){return e[t+"Error"]=Je[t],e},{}),Re=He.reduce(function(e,t){return["Syntax","Type","Range"].indexOf(t)===-1&&(e[t+"Error"]=Je[t]),e},{});Re.ModifyError=L,Re.DexieError=N,Re.BulkError=z;var Ue={},Ve=100,We=20,$e=!1,Ze=Te.setImmediate?setImmediate.bind(null,Z):Te.MutationObserver?function(){var e=document.createElement("div");new MutationObserver(function(){Z(),e=null}).observe(e,{attributes:!0}),e.setAttribute("i","1")}:function(){setTimeout(Z,0)},Qe=function(e,t){rt.push([e,t]),Xe&&(Ze(),Xe=!1)},Ye=!0,Xe=!0,et=[],tt=[],nt=null,ot=i,it={global:!0,ref:0,unhandleds:[],onunhandled:ue,finalize:function(){this.unhandleds.forEach(function(e){try{ue(e[0],e[1])}catch(e){}})}},at=it,rt=[],st=0,ut=[];f(K.prototype,{then:function(e,t){var n=this,o=new K(function(o,i){U(n,new G(e,t,o,i))});return _e&&(!this._prev||null===this._state)&&$(o,this),o},_then:function(e,t){U(this,new G(null,null,e,t))},catch:function(e){if(1===arguments.length)return this.then(null,e);var t=arguments[0],n=arguments[1];return"function"==typeof t?this.then(null,function(e){return e instanceof t?n(e):ie(e)}):this.then(null,function(e){return e&&e.name===t?n(e):ie(e)})},finally:function(e){return this.then(function(t){return e(),t},function(t){return e(),ie(t)})},uncaught:function(e){var t=this;return this.onuncatched=l(this.onuncatched,e),this._state===!1&&et.indexOf(this)===-1&&et.some(function(e,n,o){return e._value===t._value&&(o[n]=t)}),this},stack:{get:function(){if(this._stack)return this._stack;try{$e=!0;var e=W(this,[],We),t=e.join("\nFrom previous: ");return null!==this._state&&(this._stack=t),t}finally{$e=!1}}}}),f(K,{all:function(){var e=j.apply(null,arguments);return new K(function(t,n){0===e.length&&t([]);var o=e.length;e.forEach(function(i,a){return K.resolve(i).then(function(n){e[a]=n,--o||t(e)},n)})})},resolve:function(e){return e&&"function"==typeof e.then?e:new K(Ue,(!0),e)},reject:ie,race:function(){var e=j.apply(null,arguments);return new K(function(t,n){e.map(function(e){return K.resolve(e).then(t,n)})})},PSD:{get:function(){return at},set:function(e){return at=e}},newPSD:re,usePSD:se,scheduler:{get:function(){return Qe},set:function(e){Qe=e}},rejectionMapper:{get:function(){return ot},set:function(e){ot=e}},follow:function(e){return new K(function(t,n){return re(function(t,n){var o=at;o.unhandleds=[],o.onunhandled=n,o.finalize=r(function(){var e=this;ee(function(){0===e.unhandleds.length?t():n(e.unhandleds[0])})},o.finalize),e()},t,n)})},on:F(null,{error:[l,oe]})}),w(function(){Qe=function(e,t){setTimeout(function(){e.apply(null,t)},0)}});var ct="1.4.2",lt=String.fromCharCode(65535),ht=function(){try{return IDBKeyRange.only([[]]),[[]]}catch(e){return lt}}(),dt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",mt="String expected.",ft=[],pt="undefined"!=typeof navigator&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),gt=pt,vt=pt,bt=function(e){return!/(dexie\.js|dexie\.min\.js)/.test(e)};e(_e,bt);var yt=function(){},wt=!1,kt=Te.idbModules&&Te.idbModules.shimIndexedDB?Te.idbModules:{};return f(ce,Re),f(ce,{delete:function(e){var t=new ce(e),n=t.delete();return n.onblocked=function(e){return t.on("blocked",e),this},n},exists:function(e){return new ce(e).open().then(function(e){return e.close(),!0}).catch(ce.NoSuchDatabaseError,function(){return!1})},getDatabaseNames:function(e){return new K(function(e,t){var n=Se(indexedDB);if(n){var o=n();o.onsuccess=function(t){e(b(t.target.result,0))},o.onerror=fe(t)}else ve(function(t){return e(t),!1})}).then(e)},defineClass:function(e){function t(t){t?d(this,t):wt&&he(this,e)}return t},applyStructure:he,ignoreTransaction:function(e){return at.trans?se(at.transless,e):e()},vip:function(e){return re(function(){return at.letThrough=!0,e()})},async:function(e){return function(){try{var t=be(e.apply(this,arguments));return t&&"function"==typeof t.then?t:K.resolve(t)}catch(e){return O(e)}}},spawn:function(e,t,n){try{var o=be(e.apply(n,t||[]));return o&&"function"==typeof o.then?o:K.resolve(o)}catch(e){return O(e)}},currentTransaction:{get:function(){return at.trans||null}},Promise:K,debug:{get:function(){return _e},set:function(t){e(t,"dexie"===t?function(){return!0}:bt)}},derive:g,extend:d,props:f,override:y,Events:F,events:F,getByKeyPath:A,setByKeyPath:T,delByKeyPath:C,shallowClone:E,deepClone:P,getObjectDiff:M,asap:S,maxKey:ht,addons:[],connections:ft,MultiModifyError:Je.Modify,errnames:Ke,IndexSpec:ye,TableSchema:we,dependencies:{indexedDB:kt.shimIndexedDB||Te.indexedDB||Te.mozIndexedDB||Te.webkitIndexedDB||Te.msIndexedDB,IDBKeyRange:kt.IDBKeyRange||Te.IDBKeyRange||Te.webkitIDBKeyRange},semVer:ct,version:ct.split(".").map(function(e){return parseInt(e)}).reduce(function(e,t,n){return e+t/Math.pow(10,2*n)}),fakeAutoComplete:yt,default:ce}),I(function(){ce.dependencies.localStorage=null!=("undefined"!=typeof chrome&&null!==chrome?chrome.storage:void 0)?null:Te.localStorage}),K.rejectionMapper=H,w(function(){ce.fakeAutoComplete=yt=w,ce.fake=wt=!0}),ce});var db=new Dexie("oceansdb-v1");db.version(1).stores({oceans:"name"}),db.open().catch(function(e){console.log("Open failed: "+e)}),function(){function e(){var e=document.createElement("div");this.addEventListener=function(t,n){e.addEventListener(t,n.bind(this))},this.removeEventListener=function(t,n){e.removeEventListener(t,n.bind(this))},this.dispatchEvent=function(t){if("string"==typeof t)try{e.dispatchEvent(new Event(t))}catch(o){var n=document.createEvent("Event");n.initEvent(t,!1,!0),e.dispatchEvent(n)}}}function t(t,n){e.call(this);var o=l;Object.defineProperties(this,{close:{value:function(e){o===l&&(window.external.msSiteModeClearIconOverlay(),h.forEach(function(e){window.removeEventListener(e,this.close)}.bind(this)),this.dispatchEvent("click"),this.dispatchEvent("close"),o=null)}.bind(this)}}),this.close(),this.icon&&window.external.msSiteModeSetIconOverlay(d(this.icon),this.description||this.title),window.external.msSiteModeActivate(),this.dispatchEvent("show"),h.forEach(function(e){window.addEventListener(e,this.close)}.bind(this)),o=++l}function n(){}function o(e,t){var n,o;if(!arguments.length)throw TypeError('Failed to construct "Notification": 1 argument required, but only 0 present.');if(""===e&&(e="\b"),arguments.length>1&&"object"!=typeof t)throw TypeError('Failed to construct "Notification": parameter 2 ("options") is not an object.');if(n=Object(t).dir,void 0!==n&&c.indexOf(n)===-1)throw TypeError('Failed to construct "Notification": The provided value "'+n+'" is not a valid enum value of type NotificationDirection.');return t=Object(t),o=new m(e,t),o.body||Object.defineProperty(o,"body",{value:String(t.body||"")}),o.data||Object.defineProperty(o,"data",{value:t.data||null}),o.dir||Object.defineProperty(o,"dir",{value:n||c[0]}),o.icon||Object.defineProperty(o,"icon",{value:String(t.icon||"")}),o.lang||Object.defineProperty(o,"lang",{value:String(t.lang||"")}),o.requireInteraction||Object.defineProperty(o,"requireInteraction",{value:Boolean(t.requireInteraction)}),o.silent||Object.defineProperty(o,"silent",{value:Boolean(t.silent)}),o.tag||Object.defineProperty(o,"tag",{value:String(t.tag||"")}),o.title||Object.defineProperty(o,"title",{value:String(e)}),o.timestamp||Object.defineProperty(o,"timestamp",{value:(new Date).getTime()}),o}var i="default",a="granted",r="denied",s="notsupported",u=[a,i,r,s],c=["auto","ltr","rtl"],l=-1,h=["click","scroll","focus"],d=function(e){var t=e.lastIndexOf(".");return(t!==-1?e.substr(0,t):e)+".ico"},m=window.Notification||window.webkitNotifications&&n||"external"in window&&"msIsSiteMode"in window.external&&void 0!==window.external.msIsSiteMode()&&t||e;Object.defineProperty(e,"permission",{enumerable:!0,get:function(){return s}}),Object.defineProperty(e,"requestPermission",{enumerable:!0,writable:!0,value:function(e){e(this.permission)}}),Object.defineProperty(t,"permission",{enumerable:!0,get:function(){var e=window.external.msIsSiteMode();return e?a:r}}),Object.defineProperty(t,"requestPermission",{enumerable:!0,writable:!0,value:function(e){return new Promise(function(e,t){this.permission===r&&alert(this.PERMISSION_REQUEST_MESSAGE),e(this.permission)}.bind(this))}}),Object.defineProperty(t,"PERMISSION_REQUEST_MESSAGE",{writable:!0,value:"IE supports notifications in pinned mode only. Pin this page on your taskbar to receive notifications."}),Object.defineProperty(n,"permission",{enumerable:!0,get:function(){return u[window.webkitNotifications.checkPermission()]}}),Object.defineProperty(n,"requestPermission",{enumerable:!0,writable:!0,value:function(e){return new Promise(function(e,t){window.webkitNotifications.requestPermission(function(t){e(t)})})}}),m.permission||Object.defineProperty(m,"permission",{enumerable:!0,get:function(){return m.permissionLevel&&m.permissionLevel()}}),Object.defineProperty(o,"permission",{enumerable:!0,get:function(){return m.permission}}),Object.defineProperty(o,"requestPermission",{enumerable:!0,value:function(){return new Promise(function(e,t){var n=m.requestPermission(function(t){e(t)});n instanceof Promise&&e(n)})}}),window.Notification=o}(),function(e){"use strict";var t=window.angular.module("angular-web-notification",[]);t.factory("webNotification",function(){var t={};t.lib=e,t.allowRequest=!0,Object.defineProperty(t,"permissionGranted",{get:function(){var t=e.permission,n=!1;return"granted"===t&&(n=!0),n}});var n=function(){},o=function(){return t.permissionGranted},i=function(t,n){var o=0;n.autoClose&&"number"==typeof n.autoClose&&(o=n.autoClose),n.icon||(n.icon="/favicon.ico");var i=new e(t,n);n.onClick&&i&&(i.onclick=n.onClick);var a=function(){i.close()};return o&&setTimeout(a,o),a},a=function(e){var t=n;e.length&&"function"==typeof e[e.length-1]&&(t=e.pop());var o=null,i=null;if(2===e.length)o=e[0],i=e[1];else if(1===e.length){var a=e.pop();"string"==typeof a?(o=a,i={}):(o="",i=a)}return o=o||"",i=i||{},{callback:t,title:o,options:i}};return t.showNotification=function(){var n=Array.prototype.slice.call(arguments,0);if(n.length>=1&&n.length<=3){var r=a(n),s=r.callback,u=r.title,c=r.options,l=null;o()?(l=i(u,c),s(null,l)):t.allowRequest?e.requestPermission(function(){o()?(l=i(u,c),s(null,l)):s(new Error("Notifications are not enabled."),null)}):s(new Error("Notifications are not enabled."),null)}},t})}(window.Notification),function(e,t){function n(){e.removeEventListener("load",n,!1),s=!0}function o(e){return u=u||new o.Class(e)}function i(e,t){for(var n in t)e[n]=t[n];return e}function a(){"#ath"==t.location.hash&&history.replaceState("",e.document.title,t.location.href.split("#")[0]),c.test(t.location.href)&&history.replaceState("",e.document.title,t.location.href.replace(c,"$1")),l.test(t.location.search)&&history.replaceState("",e.document.title,t.location.href.replace(l,"$2"))}var r="addEventListener"in e,s=!1;"complete"===t.readyState?s=!0:r&&e.addEventListener("load",n,!1);var u,c=/\/ath(\/)?$/,l=/([\?&]ath=[^&]*$|&ath=[^&]*(&))/;o.intl={cs_cs:{ios:"Pro přidáni této webové aplikace na úvodní obrazovku: stlačte %icon a pak <strong>Přidat na úvodní obrazovku</strong>.",android:'Pro přidáni této webové aplikace na úvodní obrazovku otevřete menu nastavení prohlížeče a stlačte <strong>Přidat na úvodní obrazovku</strong>. <small>K menu se dostanete stlačením hardwaroveho tlačítka, když ho vaše zařízení má, nebo stlačením pravé horní menu ikony <span class="ath-action-icon">icon</span>.</small>'},de_de:{ios:"Um diese Web-App zum Home-Bildschirm hinzuzufügen, tippen Sie auf %icon und dann <strong>Zum Home-Bildschirm</strong>.",android:"Um diese Web-App zum Home-Bildschirm hinzuzufügen, öffnen Sie das Menü und tippen dann auf <strong>Zum Startbildschirm hinzufügen</strong>. <small>Wenn Ihr Gerät eine Menütaste hat, lässt sich das Browsermenü über diese öffnen. Ansonsten tippen Sie auf %icon.</small>"},da_dk:{ios:"For at tilføje denne web app til hjemmeskærmen: Tryk %icon og derefter <strong>Føj til hjemmeskærm</strong>.",android:"For at tilføje denne web app til hjemmeskærmen, åbn browser egenskaber menuen og tryk på <strong>Føj til hjemmeskærm</strong>. <small>Denne menu kan tilgås ved at trykke på menu knappen, hvis din enhed har en, eller ved at trykke på det øverste højre menu ikon %icon.</small>"},el_gr:{ios:"Για να προσθέσετε την εφαρμογή στην αρχική οθόνη: πατήστε το %icon και μετά <strong>Πρόσθεσε στην αρχική οθόνη</strong>.",android:"Για να προσθέσετε την εφαρμογή στην αρχική οθόνη, ανοίξτε τις επιλογές του browser σας και πατήστε το <strong>Προσθήκη στην αρχική οθόνη</strong>. <small>Μπορείτε να έχετε πρόσβαση στο μενού, πατώντας το κουμπί του μενού του κινητού σας ή το πάνω δεξιά κουμπί του μενού %icon.</small>"},en_us:{ios:"To add this web app to the home screen: tap %icon and then <strong>Add to Home Screen</strong>.",android:"To add this web app to the home screen open the browser option menu and tap on <strong>Add to homescreen</strong>. <small>The menu can be accessed by pressing the menu hardware button if your device has one, or by tapping the top right menu icon %icon.</small>"},es_es:{ios:"Para añadir esta aplicación web a la pantalla de inicio: pulsa %icon y selecciona <strong>Añadir a pantalla de inicio</strong>.",android:"Para añadir esta aplicación web a la pantalla de inicio, abre las opciones y pulsa <strong>Añadir a pantalla inicio</strong>. <small>El menú se puede acceder pulsando el botón táctil en caso de tenerlo, o bien el icono de la parte superior derecha de la pantalla %icon.</small>"},fi_fi:{ios:"Liitä tämä sovellus kotivalikkoon: klikkaa %icon ja tämän jälkeen <strong>Lisää kotivalikkoon</strong>.",android:"Lisätäksesi tämän sovelluksen aloitusnäytölle, avaa selaimen valikko ja klikkaa tähti -ikonia tai <strong>Lisää aloitusnäytölle tekstiä</strong>. <small>Valikkoon pääsee myös painamalla menuvalikkoa, jos laitteessasi on sellainen tai koskettamalla oikealla yläkulmassa menu ikonia %icon.</small>"},fr_fr:{ios:"Pour ajouter cette application web sur l'écran d'accueil : Appuyez %icon et sélectionnez <strong>Ajouter sur l'écran d'accueil</strong>.",android:'Pour ajouter cette application web sur l\'écran d\'accueil : Appuyez sur le bouton "menu", puis sur <strong>Ajouter sur l\'écran d\'accueil</strong>. <small>Le menu peut-être accessible en appuyant sur le bouton "menu" du téléphone s\'il en possède un <i class="fa fa-bars"></i>. Sinon, il se trouve probablement dans la coin supérieur droit du navigateur %icon.</small>'},he_il:{ios:'<span dir="rtl">להוספת האפליקציה למסך הבית: ללחוץ על %icon ואז <strong>הוסף למסך הבית</strong>.</span>',android:"To add this web app to the home screen open the browser option menu and tap on <strong>Add to homescreen</strong>. <small>The menu can be accessed by pressing the menu hardware button if your device has one, or by tapping the top right menu icon %icon.</small>"},hu_hu:{ios:"Ha hozzá szeretné adni ezt az alkalmazást a kezdőképernyőjéhez, érintse meg a következő ikont: %icon , majd a <strong>Hozzáadás a kezdőképernyőhöz</strong> menüpontot.",android:"Ha hozzá szeretné adni ezt az alkalmazást a kezdőképernyőjéhez, a böngésző menüjében kattintson a <strong>Hozzáadás a kezdőképernyőhöz</strong> menüpontra. <small>A böngésző menüjét a következő ikon megérintésével tudja megnyitni: %icon.</small>"},it_it:{ios:"Per aggiungere questa web app alla schermata iniziale: premi %icon e poi <strong>Aggiungi a Home</strong>.",android:"Per aggiungere questa web app alla schermata iniziale, apri il menu opzioni del browser e premi su <strong>Aggiungi alla homescreen</strong>. <small>Puoi accedere al menu premendo il pulsante hardware delle opzioni se la tua device ne ha uno, oppure premendo l'icona %icon in alto a destra.</small>"},ja_jp:{ios:"このウェプアプリをホーム画面に追加するには、%iconをタップして<strong>ホーム画面に追加</strong>してください。",android:"このウェプアプリをホーム画面に追加するには、ブラウザのオプションメニューから<strong>ホーム画面に追加</strong>をタップしてください。<small>オプションメニューは、一部の機種ではデバイスのメニューボタンから、それ以外では画面右上の%iconからアクセスできます。</small>"},ko_kr:{
ios:"홈 화면에 바로가기 생성: %icon 을 클릭한 후 <strong>홈 화면에 추가</strong>.",android:"브라우저 옵션 메뉴의 <string>홈 화면에 추가</string>를 클릭하여 홈화면에 바로가기를 생성할 수 있습니다. <small>옵션 메뉴는 장치의 메뉴 버튼을 누르거나 오른쪽 상단의 메뉴 아이콘 %icon을 클릭하여 접근할 수 있습니다.</small>"},nb_no:{ios:"For å installere denne appen på hjem-skjermen: trykk på %icon og deretter <strong>Legg til på Hjem-skjerm</strong>.",android:"For å legge til denne webappen på startsiden åpner en nettlesermenyen og velger <strong>Legg til på startsiden</strong>. <small>Menyen åpnes ved å trykke på den fysiske menyknappen hvis enheten har det, eller ved å trykke på menyikonet øverst til høyre %icon.</small>"},pt_br:{ios:"Para adicionar este app à tela de início: clique %icon e então <strong>Tela de início</strong>.",android:'Para adicionar este app à tela de início, abra o menu de opções do navegador e selecione <strong>Adicionar à tela inicial</strong>. <small>O menu pode ser acessado pressionando o "menu" button se o seu dispositivo tiver um, ou selecionando o ícone %icon no canto superior direito.</small>'},pt_pt:{ios:"Para adicionar esta app ao ecrã principal: clique %icon e depois <strong>Ecrã principal</strong>.",android:'Para adicionar esta app web ecrã principal, abra o menu de opções do navegador e selecione <strong>Adicionar à tela inicial</strong>. <small>O menu pode ser acessado pressionando o "menu" button se o seu dispositivo tiver um, ou selecionando o ícone %icon no canto superior direito.</small>'},nl_nl:{ios:"Om deze webapp aan je startscherm toe te voegen, klik op %icon en dan <strong>Zet in startscherm</strong>.",android:'Om deze webapp aan je startscherm toe te voegen, open de browserinstellingen en tik op <strong>Toevoegen aan startscherm</strong>. <small>Gebruik de "menu" knop als je telefoon die heeft, anders het menu-icoon rechtsbovenin %icon.</small>'},ru_ru:{ios:'Чтобы добавить этот сайт на свой домашний экран, нажмите на иконку %icon и затем <strong>На экран "Домой"</strong>.',android:"Чтобы добавить сайт на свой домашний экран, откройте меню браузера и нажмите на <strong>Добавить на главный экран</strong>. <small>Меню можно вызвать, нажав на кнопку меню вашего телефона, если она есть. Или найдите иконку сверху справа %icon[иконка].</small>"},sk_sk:{ios:"Pre pridanie tejto webovej aplikácie na úvodnú obrazovku: stlačte %icon a potom <strong>Pridať na úvodnú obrazovku</strong>.",android:'Pre pridanie tejto webovej aplikácie na úvodnú obrazovku otvorte menu nastavenia prehliadača a stlačte <strong>Pridať na úvodnú obrazovku</strong>. <small>K menu sa dostanete stlačením hardwaroveho tlačidla, ak ho vaše zariadenie má, alebo stlačením pravej hornej menu ikony <span class="ath-action-icon">icon</span>.</small>'},sv_se:{ios:"För att lägga till denna webbapplikation på hemskärmen: tryck på %icon och därefter <strong>Lägg till på hemskärmen</strong>.",android:"För att lägga till den här webbappen på hemskärmen öppnar du webbläsarens alternativ-meny och väljer <strong>Lägg till på startskärmen</strong>. <small>Man hittar menyn genom att trycka på hårdvaruknappen om din enhet har en sådan, eller genom att trycka på menyikonen högst upp till höger %icon.</small>"},tr_tr:{ios:"Uygulamayı ana ekrana eklemek için, %icon ve ardından <strong>ana ekrana ekle</strong> butonunu tıklayın.",android:"Uygulamayı ana ekrana eklemek için, menüye girin ve <strong>ana ekrana ekle</strong> butonunu tıklayın. <small>Cihazınız menü tuşuna sahip ise menüye girmek için menü tuşunu tıklayın. Aksi takdirde %icon butonunu tıklayın.</small>"},uk_ua:{ios:"Щоб додати цей сайт на початковий екран, натисніть %icon, а потім <strong>На початковий екран</strong>.",android:"Щоб додати цей сайт на домашній екран, відкрийте меню браузера та виберіть <strong>Додати на головний екран</strong>. <small>Це можливо зробити, натиснувши кнопку меню на вашому смартфоні, якщо така є. Або ж на іконці зверху справа %icon.</small>"},zh_cn:{ios:"如要把应用程序加至主屏幕,请点击%icon, 然后<strong>添加到主屏幕</strong>",android:"To add this web app to the home screen open the browser option menu and tap on <strong>Add to homescreen</strong>. <small>The menu can be accessed by pressing the menu hardware button if your device has one, or by tapping the top right menu icon %icon.</small>"},zh_tw:{ios:"如要把應用程式加至主屏幕, 請點擊%icon, 然後<strong>加至主屏幕</strong>.",android:"To add this web app to the home screen open the browser option menu and tap on <strong>Add to homescreen</strong>. <small>The menu can be accessed by pressing the menu hardware button if your device has one, or by tapping the top right menu icon %icon.</small>"}};for(var h in o.intl)o.intl[h.substr(0,2)]=o.intl[h];o.defaults={appID:"org.cubiq.addtohome",fontSize:15,debug:!1,logging:!1,modal:!1,mandatory:!1,autostart:!0,skipFirstVisit:!1,startDelay:1,lifespan:15,displayPace:1440,maxDisplayCount:0,icon:!0,message:"",validLocation:[],onInit:null,onShow:null,onRemove:null,onAdd:null,onPrivate:null,privateModeOverride:!1,detectHomescreen:!1};var d=e.navigator.userAgent,m=e.navigator;i(o,{hasToken:"#ath"==t.location.hash||c.test(t.location.href)||l.test(t.location.search),isRetina:e.devicePixelRatio&&e.devicePixelRatio>1,isIDevice:/iphone|ipod|ipad/i.test(d),isMobileChrome:d.indexOf("Android")>-1&&/Chrome\/[.0-9]*/.test(d)&&d.indexOf("Version")==-1,isMobileIE:d.indexOf("Windows Phone")>-1,language:m.language&&m.language.toLowerCase().replace("-","_")||""}),o.language=o.language&&o.language in o.intl?o.language:"en_us",o.isMobileSafari=o.isIDevice&&d.indexOf("Safari")>-1&&d.indexOf("CriOS")<0,o.OS=o.isIDevice?"ios":o.isMobileChrome?"android":o.isMobileIE?"windows":"unsupported",o.OSVersion=d.match(/(OS|Android) (\d+[_\.]\d+)/),o.OSVersion=o.OSVersion&&o.OSVersion[2]?+o.OSVersion[2].replace("_","."):0,o.isStandalone="standalone"in e.navigator&&e.navigator.standalone,o.isTablet=o.isMobileSafari&&d.indexOf("iPad")>-1||o.isMobileChrome&&d.indexOf("Mobile")<0,o.isCompatible=o.isMobileSafari&&o.OSVersion>=6||o.isMobileChrome;var f={lastDisplayTime:0,returningVisitor:!1,displayCount:0,optedout:!1,added:!1};o.removeSession=function(e){try{if(!localStorage)throw new Error("localStorage is not defined");localStorage.removeItem(e||o.defaults.appID)}catch(e){}},o.doLog=function(e){this.options.logging&&console.log(e)},o.Class=function(n){if(this.doLog=o.doLog,this.options=i({},o.defaults),i(this.options,n),this.options&&this.options.debug&&"undefined"==typeof this.options.logging&&(this.options.logging=!0),r){if(this.options.mandatory=this.options.mandatory&&("standalone"in e.navigator||this.options.debug),this.options.modal=this.options.modal||this.options.mandatory,this.options.mandatory&&(this.options.startDelay=-.5),this.options.detectHomescreen=this.options.detectHomescreen===!0?"hash":this.options.detectHomescreen,this.options.debug&&(o.isCompatible=!0,o.OS="string"==typeof this.options.debug?this.options.debug:"unsupported"==o.OS?"android":o.OS,o.OSVersion="ios"==o.OS?"8":"4"),this.container=t.body,this.session=this.getItem(this.options.appID),this.session=this.session?JSON.parse(this.session):void 0,!o.hasToken||o.isCompatible&&this.session||(o.hasToken=!1,a()),!o.isCompatible)return void this.doLog("Add to homescreen: not displaying callout because device not supported");this.session=this.session||f;try{if(!localStorage)throw new Error("localStorage is not defined");localStorage.setItem(this.options.appID,JSON.stringify(this.session)),o.hasLocalStorage=!0}catch(e){o.hasLocalStorage=!1,this.options.onPrivate&&this.options.onPrivate.call(this)}for(var s=!this.options.validLocation.length,u=this.options.validLocation.length;u--;)if(this.options.validLocation[u].test(t.location.href)){s=!0;break}if(this.getItem("addToHome")&&this.optOut(),this.session.optedout)return void this.doLog("Add to homescreen: not displaying callout because user opted out");if(this.session.added)return void this.doLog("Add to homescreen: not displaying callout because already added to the homescreen");if(!s)return void this.doLog("Add to homescreen: not displaying callout because not a valid location");if(o.isStandalone)return this.session.added||(this.session.added=!0,this.updateSession(),this.options.onAdd&&o.hasLocalStorage&&this.options.onAdd.call(this)),void this.doLog("Add to homescreen: not displaying callout because in standalone mode");if(this.options.detectHomescreen){if(o.hasToken)return a(),this.session.added||(this.session.added=!0,this.updateSession(),this.options.onAdd&&o.hasLocalStorage&&this.options.onAdd.call(this)),void this.doLog("Add to homescreen: not displaying callout because URL has token, so we are likely coming from homescreen");"hash"==this.options.detectHomescreen?history.replaceState("",e.document.title,t.location.href+"#ath"):"smartURL"==this.options.detectHomescreen?history.replaceState("",e.document.title,t.location.href.replace(/(\/)?$/,"/ath$1")):history.replaceState("",e.document.title,t.location.href+(t.location.search?"&":"?")+"ath=")}if(!this.session.returningVisitor&&(this.session.returningVisitor=!0,this.updateSession(),this.options.skipFirstVisit))return void this.doLog("Add to homescreen: not displaying callout because skipping first visit");if(!this.options.privateModeOverride&&!o.hasLocalStorage)return void this.doLog("Add to homescreen: not displaying callout because browser is in private mode");this.ready=!0,this.options.onInit&&this.options.onInit.call(this),this.options.autostart&&(this.doLog("Add to homescreen: autostart displaying callout"),this.show())}},o.Class.prototype={events:{load:"_delayedShow",error:"_delayedShow",orientationchange:"resize",resize:"resize",scroll:"resize",click:"remove",touchmove:"_preventDefault",transitionend:"_removeElements",webkitTransitionEnd:"_removeElements",MSTransitionEnd:"_removeElements"},handleEvent:function(e){var t=this.events[e.type];t&&this[t](e)},show:function(n){if(this.options.autostart&&!s)return void setTimeout(this.show.bind(this),50);if(this.shown)return void this.doLog("Add to homescreen: not displaying callout because already shown on screen");var i=Date.now(),a=this.session.lastDisplayTime;if(n!==!0){if(!this.ready)return void this.doLog("Add to homescreen: not displaying callout because not ready");if(i-a<6e4*this.options.displayPace)return void this.doLog("Add to homescreen: not displaying callout because displayed recently");if(this.options.maxDisplayCount&&this.session.displayCount>=this.options.maxDisplayCount)return void this.doLog("Add to homescreen: not displaying callout because displayed too many times already")}this.shown=!0,this.session.lastDisplayTime=i,this.session.displayCount++,this.updateSession(),this.applicationIcon||("ios"==o.OS?this.applicationIcon=t.querySelector('head link[rel^=apple-touch-icon][sizes="152x152"],head link[rel^=apple-touch-icon][sizes="144x144"],head link[rel^=apple-touch-icon][sizes="120x120"],head link[rel^=apple-touch-icon][sizes="114x114"],head link[rel^=apple-touch-icon]'):this.applicationIcon=t.querySelector('head link[rel^="shortcut icon"][sizes="196x196"],head link[rel^=apple-touch-icon]'));var r="";"object"==typeof this.options.message&&o.language in this.options.message?r=this.options.message[o.language][o.OS]:"object"==typeof this.options.message&&o.OS in this.options.message?r=this.options.message[o.OS]:this.options.message in o.intl?r=o.intl[this.options.message][o.OS]:""!==this.options.message?r=this.options.message:o.OS in o.intl[o.language]&&(r=o.intl[o.language][o.OS]),r="<p>"+r.replace(/%icon(?:\[([^\]]+)\])?/gi,function(e,t){return'<span class="ath-action-icon">'+(t?t:"icon")+"</span>"})+"</p>",this.viewport=t.createElement("div"),this.viewport.className="ath-viewport",this.options.modal&&(this.viewport.className+=" ath-modal"),this.options.mandatory&&(this.viewport.className+=" ath-mandatory"),this.viewport.style.position="absolute",this.element=t.createElement("div"),this.element.className="ath-container ath-"+o.OS+" ath-"+o.OS+(parseInt(o.OSVersion)||"")+" ath-"+(o.isTablet?"tablet":"phone"),this.element.style.cssText="-webkit-transition-property:-webkit-transform,opacity;-webkit-transition-duration:0s;-webkit-transition-timing-function:ease-out;transition-property:transform,opacity;transition-duration:0s;transition-timing-function:ease-out;",this.element.style.webkitTransform="translate3d(0,-"+e.innerHeight+"px,0)",this.element.style.transform="translate3d(0,-"+e.innerHeight+"px,0)",this.options.icon&&this.applicationIcon&&(this.element.className+=" ath-icon",this.img=t.createElement("img"),this.img.className="ath-application-icon",this.img.addEventListener("load",this,!1),this.img.addEventListener("error",this,!1),this.img.src=this.applicationIcon.href,this.element.appendChild(this.img)),this.element.innerHTML+=r,this.viewport.style.left="-99999em",this.viewport.appendChild(this.element),this.container.appendChild(this.viewport),this.img?this.doLog("Add to homescreen: not displaying callout because waiting for img to load"):this._delayedShow()},_delayedShow:function(e){setTimeout(this._show.bind(this),1e3*this.options.startDelay+500)},_show:function(){var n=this;this.updateViewport(),e.addEventListener("resize",this,!1),e.addEventListener("scroll",this,!1),e.addEventListener("orientationchange",this,!1),this.options.modal&&t.addEventListener("touchmove",this,!0),this.options.mandatory||setTimeout(function(){n.element.addEventListener("click",n,!0)},1e3),setTimeout(function(){n.element.style.webkitTransitionDuration="1.2s",n.element.style.transitionDuration="1.2s",n.element.style.webkitTransform="translate3d(0,0,0)",n.element.style.transform="translate3d(0,0,0)"},0),this.options.lifespan&&(this.removeTimer=setTimeout(this.remove.bind(this),1e3*this.options.lifespan)),this.options.onShow&&this.options.onShow.call(this)},remove:function(){clearTimeout(this.removeTimer),this.img&&(this.img.removeEventListener("load",this,!1),this.img.removeEventListener("error",this,!1)),e.removeEventListener("resize",this,!1),e.removeEventListener("scroll",this,!1),e.removeEventListener("orientationchange",this,!1),t.removeEventListener("touchmove",this,!0),this.element.removeEventListener("click",this,!0),this.element.addEventListener("transitionend",this,!1),this.element.addEventListener("webkitTransitionEnd",this,!1),this.element.addEventListener("MSTransitionEnd",this,!1),this.element.style.webkitTransitionDuration="0.3s",this.element.style.opacity="0"},_removeElements:function(){this.element.removeEventListener("transitionend",this,!1),this.element.removeEventListener("webkitTransitionEnd",this,!1),this.element.removeEventListener("MSTransitionEnd",this,!1),this.container.removeChild(this.viewport),this.shown=!1,this.options.onRemove&&this.options.onRemove.call(this)},updateViewport:function(){if(this.shown){this.viewport.style.width=e.innerWidth+"px",this.viewport.style.height=e.innerHeight+"px",this.viewport.style.left=e.scrollX+"px",this.viewport.style.top=e.scrollY+"px";var n=t.documentElement.clientWidth;this.orientation=n>t.documentElement.clientHeight?"landscape":"portrait";var i="ios"==o.OS?"portrait"==this.orientation?screen.width:screen.height:screen.width;this.scale=screen.width>n?1:i/e.innerWidth,this.element.style.fontSize=this.options.fontSize/this.scale+"px"}},resize:function(){clearTimeout(this.resizeTimer),this.resizeTimer=setTimeout(this.updateViewport.bind(this),100)},updateSession:function(){o.hasLocalStorage!==!1&&localStorage&&localStorage.setItem(this.options.appID,JSON.stringify(this.session))},clearSession:function(){this.session=f,this.updateSession()},getItem:function(e){try{if(!localStorage)throw new Error("localStorage is not defined");return localStorage.getItem(e)}catch(e){o.hasLocalStorage=!1}},optOut:function(){this.session.optedout=!0,this.updateSession()},optIn:function(){this.session.optedout=!1,this.updateSession()},clearDisplayCount:function(){this.session.displayCount=0,this.updateSession()},_preventDefault:function(e){e.preventDefault(),e.stopPropagation()}},e.addToHomescreen=o}(window,document);